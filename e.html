<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Winston Churchill High School Athletics Admin Dashboard for managing sports events and statistics">
    <title>Winston Churchill High School Athletics Admin Dashboard</title>
    
    <!-- Core CSS Libraries -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-notify/dist/simple-notify.css">
    <link href="https://cdn.jsdelivr.net/npm/butteruptoasts@2.0.1/src/butterup.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Core JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-notify/dist/simple-notify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/butteruptoasts@2.0.1/dist/butterup.min.js"></script>
    <style>
        :root {
            /* Color System */
            --primary: #1a56db;
            --primary-dark: #0d47a1;
            --primary-light: #4f83cc;
            --secondary: #6c757d;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --light: #f8f9fa;
            --dark: #1f2937;
            --gray-100: #f9fafb;
            --gray-200: #f3f4f6;
            --gray-300: #e5e7eb;
            --gray-400: #d1d5db;
            --gray-500: #9ca3af;
            --gray-600: #6b7280;
            --gray-700: #4b5563;
            --gray-800: #374151;
            --gray-900: #1f2937;
            
            /* Typography */
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-heading: 'Montserrat', -apple-system, BlinkMacSystemFont, sans-serif;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Borders */
            --border-radius-sm: 0.25rem;
            --border-radius: 0.5rem;
            --border-radius-lg: 0.75rem;
            --border-radius-xl: 1rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
            
            /* Transitions */
            --transition-fast: 150ms ease;
            --transition: 300ms ease;
            --transition-slow: 500ms ease;
        }
        
        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: var(--font-primary);
            background-color: var(--gray-100);
            color: var(--gray-900);
            line-height: 1.5;
            transition: background-color var(--transition);
        }
        #message-container {
    max-height: 400px;
    overflow-y: auto;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    background-color: #f9f9f9;
}

.swal2-container {background-color:rgba(255,255,255,.42)!important;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:none;box-shadow:0 4px 12px #0000001a;color:#282828}  

.message-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    margin-bottom: 10px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    border-left: 4px solid #007bff; /* Accent for visual distinction */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.message-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.message-content {
    flex: 1;
}

.message-timestamp {
    font-size: 0.9em;
    color: #777;
    margin-left: 10px;
    text-align: right;
    flex-shrink: 0;
}

/* Dark mode compatibility */
body.dark-mode #message-container {
    background-color: #333;
}

body.dark-mode .message-card {
    background-color: #444;
    border-left: 4px solid #ffc107;
    color: #ddd;
}


        .admin-tab {
            display: none;
        }
        .container {
            margin-top: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            color: var(--gray-900);
            margin-bottom: var(--space-md);
            font-weight: 600;
            line-height: 1.3;
        }
        
        h1 {
            color: var(--primary);
            text-align: center;
            font-size: 2rem;
            margin-bottom: var(--space-xl);
            position: relative;
            padding-bottom: var(--space-md);
        }
        
        h1:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--primary);
            border-radius: 3px;
        }
        .score {
            font-size: 2em;
            margin: 20px 0;
        }
        .btn, .button {
            margin: var(--space-xs);
            padding: 0.5rem 1.25rem;
            border-radius: var(--border-radius);
            font-weight: 500;
            transition: all var(--transition-fast);
            box-shadow: var(--shadow-sm);
            border: none;
            position: relative;
            overflow: hidden;
            font-family: var(--font-primary);
        }
        
        .btn:hover, .button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .btn:active, .button:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        .enter-score-popup, .login-popup, .create-log-popup {
            display: none;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            width: 300px;
        }
        .card {
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            background-color: white;
            border: none;
            transition: transform var(--transition), box-shadow var(--transition);
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        /* AI Tab Container */
        #ai {
        padding: 20px;
        background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        max-width: 650px;
        margin: auto;
    }
    .ai-title {
        font-size: 2em;
        font-weight: bold;
        color: #007bff;
        text-align: center;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0, 123, 255, 0.3);
    }
    .ai-description {
        font-size: 1.2em;
        color: #444;
        text-align: center;
        margin-bottom: 20px;
    }
    .ai-input-group {
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: center;
    }
    .ai-input {
        flex: 1;
        padding: 12px;
        border: 1px solid #bbb;
        border-radius: 8px;
        box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .ai-input:focus {
        border-color: #007bff;
        outline: none;
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.5);
    }
    @keyframes glowing {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    .ai-submit {
        padding: 12px 25px;
        border-radius: 8px;
        font-size: 1.1em;
        font-weight: bold;
        background: linear-gradient(270deg, #00c6ff, #0072ff, #00ff00);
        background-size: 400% 400%;
        color: white;
        border: none;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.8), 0 0 20px rgba(0, 255, 0, 0.8);
        animation: glowing 3s infinite;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .ai-submit:hover {
        transform: scale(1.1);
        box-shadow: 0 0 15px rgba(0, 255, 255, 1), 0 0 30px rgba(0, 255, 0, 1);
    }
    .ai-response {
        margin-top: 20px;
        padding: 15px;
        background-color: #e9ecef;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 1.1em;
        color: #333;
        min-height: 100px;
        text-align: center;
    }
    .ai-placeholder {
        color: #777;
    }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 1);
            z-index: 999;
        }
        .connection-status {
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            color: white;
        }
        .stats {
            margin-top: 20px;
            font-size: 1.2em;
            text-align: center;
        }
        .logins {
            margin-top: 20px;
            font-size: 1.2em;
        }

.sidebar {
    height: 100vh;
    width: 280px;
    position: fixed;
    top: 0;
    left: 0;
    background: linear-gradient(145deg, var(--primary-dark), var(--dark));
    padding-top: var(--space-xl);
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: var(--shadow-lg);
    color: white;
    font-family: var(--font-primary);
    transition: width var(--transition);
    overflow-y: auto;
    overflow-x: hidden;
    z-index: 100;
}

/* Optional: Customize scrollbar */
.sidebar::-webkit-scrollbar {
    width: 8px; /* Set the width of the scrollbar */
}

.sidebar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.5);
    border-radius: 4px;
}

.sidebar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.8);
}


.sidebar h2 {
    font-size: 1.5em;
    font-weight: bold;
    color: #f39c12;
    margin-bottom: 20px;
}

.sidebar img.logo {
    width: 120px;
    border-radius: 50%;
    margin-bottom: 15px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.sidebar a {
    width: 90%;
    padding: var(--space-md) var(--space-lg);
    margin: var(--space-xs) 0;
    text-decoration: none;
    color: var(--gray-100);
    border-radius: var(--border-radius);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    transition: all var(--transition-fast);
    font-size: 0.95rem;
    font-weight: 500;
    position: relative;
    overflow: hidden;
}

.sidebar a i {
    margin-right: var(--space-md);
    font-size: 1.2em;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform var(--transition-fast);
}

.sidebar a:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

.sidebar a:hover i {
    transform: scale(1.2);
    color: var(--primary-light);
}

.sidebar a.active {
    background: var(--primary);
    color: white;
    font-weight: 600;
    box-shadow: var(--shadow-sm);
}

.sidebar button {
    margin-top: 15px;
    width: 90%;
    padding: 10px;
    font-size: 1em;
    border-radius: 5px;
    transition: background-color 0.3s ease-in-out, transform 0.2s;
}

.sidebar button:hover {
    background: #0056b3;
    transform: scale(1.05);
}

/* Responsive Sidebar */
@media (max-width: 768px) {
    .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        padding: 10px;
    }
    .sidebar a {
        text-align: center;
        justify-content: center;
    }
    .content {
        margin-left: 0;
    }
}


.sidebar #connection-label {
    font-size: 0.9em;
    margin-top: 20px;
}

.sidebar #current-time {
    font-size: 0.9em;
    margin-top: 10px;
}

        .content {
            margin-left: 280px;
            padding: var(--space-xl);
            min-height: 100vh;
            background-color: var(--gray-100);
            position: relative;
        }
       
        .navbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 10px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dark-mode {
            background-color: #343a40;
            color: white;
        }
        .dark-mode .container {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .dark-mode .sidebar {
            background-color: rgba(52, 58, 64, 0.9);
        }
        .quarter-selector {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .toggle-container {
            display: flex;
            align-items: center;
            margin-top: 20px;
        }
        .toggle-label {
            margin-right: 10px;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 34px;
            height: 20px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            border-radius: 50%;
            transition: .4s;
        }
        .message-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    background-color: white;
    z-index: 1000;
    text-align: center;
}

.message-popup textarea {
    width: 100%;
    height: 100px;
    margin-bottom: 10px;
}

.message-popup button {
    margin: 5px;
}

        input:checked + .slider {
            background-color: #007bff;
        }
        input:checked + .slider:before {
            transform: translateX(14px);
        }
        .log-card {
            border: 1px solid #007bff;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background-color: rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .search-bar {
            margin-bottom: 20px;
        }
        .logo {
            width: 100%;
            max-width: 200px;
            margin: 20px auto;
            display: block;
        }
        .info-section {
            margin-top: 20px;
            text-align: center;
        }
        .loading-spinner {
            display: none;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }
        .fade {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .fade.show {
            opacity: 1;
        }
        /* Mobile styles */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .content {
                margin-left: 0;
                padding: 10px;
            }
            .score {
                font-size: 1.5em;
            }
        }
        /* Fullscreen styles for projector mode */
        .projector-mode {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            font-size: 5em;
        }
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position above the tooltip */
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }


#sidebar-search {
    margin: 10px 0;
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: 90%;
}

.sidebar.collapsed {
    width: 80px;
    transition: width 0.3s;
}

.sidebar.collapsed a {
    font-size: 0;
    padding: 10px;
}

.sidebar.collapsed img.logo {
    width: 50px;
}

.log-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 20px;
}

.log-card {
    background: #fff;
    border: 1px solid #007bff;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.log-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.log-card .log-details {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.log-card .log-actions {
    display: flex;
    gap: 10px;
}

.log-card .log-actions button {
    padding: 5px 10px;
    font-size: 0.9em;
}

.log-controls {
    margin-top: 20px;
    display: flex;
    gap: 10px;
    justify-content: center;
}

.search-bar {
    margin-bottom: 20px;
    border-radius: 20px;
    padding: 10px;
    border: 1px solid #ccc;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.pagination-controls button {
    margin: 0 5px;
    padding: 5px 10px;
    border-radius: 5px;
    background-color: #007bff;
    color: white;
    border: none;
    transition: background-color 0.3s ease;
}

.pagination-controls button:hover {
    background-color: #0056b3;
}

.card {
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    background-color: white;
}

.card h4 {
    color: #007bff;
    font-weight: bold;
}

.card .form-control {
    border-radius: 5px;
    padding: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}


.toast {
    background: rgba(255, 255, 255, 0.1); /* Transparent white background */
    backdrop-filter: blur(10px); /* Glass effect */
    -webkit-backdrop-filter: blur(10px); /* Safari support */
    color: black;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 300px;
    animation: fadeIn 0.5s ease; /* Start with fadeIn */
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.2); /* Subtle border */
    animation-fill-mode: forwards;
}

.toast.success {
    border-left: 4px solid #4caf50; /* Green accent for success */
}

.toast.error {
    border-left: 4px solid #f44336; /* Red accent for errors */
}

.toast.warning {
    border-left: 4px solid #ff9800; /* Orange accent for warnings */
}

.toast .close-btn {
    background: none;
    border: none;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    color: rgba(0, 0, 0, 0.7);
    transition: color 0.3s ease;
}

.toast .close-btn:hover {
    color: black;
}

.login-popup {
    display: none;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #007bff, #0056b3);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    width: 350px;
    animation: fadeIn 0.3s ease-in-out;
}

.login-card {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.login-title {
    font-size: 1.8em;
    font-weight: bold;
    color: #333;
}

.login-subtitle {
    margin-top: 5px;
    color: #777;
    font-size: 0.9em;
}

.login-input {
    margin: 10px 0;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 5px;
    width: 100%;
    transition: box-shadow 0.3s ease;
}

.login-input:focus {
    box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    border-color: #007bff;
    outline: none;
}

         .maintenance-popup {
        background-color: #343a40; /* Dark background */
        color: white; /* White text */
        border-radius: 10px; /* Rounded corners */
        padding: 20px; /* Padding inside the popup */
        text-align: center; /* Center text */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); /* Shadow effect */
    }

    /* Add some cool animations */


.login-actions {
    margin-top: 15px;
}

.login-error {
    color: red;
    margin-top: 10px;
    font-size: 0.85em;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translate(-50%, -55%);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%);
    }
}


/* Animations */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeOut {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(20px);
    }
}

.card h3 {
    font-size: 1.5rem;
}

.btn-group .btn {
    font-size: 1.2rem;
}

.display-4 {
    font-size: 2.5rem;
}



/* Overlay */
.popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent background */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease-in-out;
}

/* Popup Container */
.popup-container {
  background: white;
  border-radius: 15px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  width: 90%;
  max-width: 400px;
  animation: slideIn 0.3s ease;
}

/* Header */
.popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #f0f0f0;
}

.popup-header h2 {
  margin: 0;
  font-size: 1.5em;
  color: #333;
}

.close-btn {
  background: none;
  border: none;
  font-size: 1.5em;
  color: #666;
  cursor: pointer;
  transition: color 0.2s ease;
}

.close-btn:hover {
  color: #333;
}

/* Content */
.popup-content {
  padding: 20px;
  font-size: 1em;
  line-height: 1.5;
  color: #555;
}

/* Footer */
.popup-footer {
  padding: 20px;
  text-align: center;
  border-top: 1px solid #f0f0f0;
}

.btn-primary {
  padding: 10px 20px;
  font-size: 1em;
  color: white;
  background-color: #007bff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.btn-primary:hover {
  background-color: #0056b3;
}

/* Animations */
@keyframes slideIn {
  from {
    transform: translateY(-50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Show popup */
.popup-overlay.active {
  opacity: 1;
  pointer-events: all;
}

#game-summary-container {
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 20px;
    background-color: #f9f9f9;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

#game-summary-container h3 {
    color: #007bff;
    margin-bottom: 10px;
}

#game-summary {
    font-size: 1.1em;
    color: #333;
    line-height: 1.5;
}


/* General Styling for Rosters Page */
#roster {
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

/* Center Text and Spacing */
#roster h2 {
    font-weight: bold;
    margin-bottom: 20px;
}

#whats-new-popup ul li {
  margin: 10px 0;
  display: flex;
  align-items: center;
  font-size: 1.1em;
}

#whats-new-popup ul li i {
  margin-right: 10px;
  color: #007bff;
  font-size: 1.2em;
}


.roster-controls select {
    font-size: 1.1em;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* General Inbox Styling */
#inbox {
  padding: 20px;
}

.search-bar {
  border-radius: 20px;
  padding: 10px;
  border: 1px solid #ccc;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;
}

/* Message Card Styling */
.message-card {
  display: flex;
  align-items: center;
  padding: 15px;
  margin-bottom: 10px;
  background-color: #fff;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.message-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
}

/* Avatar Section */
.message-avatar {
  margin-right: 15px;
  font-size: 2em;
  color: #007bff;
}

/* Content Section */
.message-content {
  flex-grow: 1;
}

.message-sender {
  font-size: 1.1em;
  font-weight: bold;
  color: #333;
}

.message-preview {
  margin: 5px 0;
  font-size: 0.9em;
  color: #555;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}

.message-timestamp {
  font-size: 0.8em;
  color: #888;
}

/* General Styling for Game Titles */
#title {
  padding: 20px;
}

.title-input {
  border-radius: 5px;
  padding: 10px;
  border: 1px solid #ccc;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  transition: border-color 0.3s ease;
}

.title-input:focus {
  border-color: #007bff;
  outline: none;
  box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
}

/* Card Styling for Preview */
.card {
  border-radius: 10px;
  background-color: #f8f9fa;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.card h4 {
  color: #007bff;
  font-weight: bold;
}

/* General Styling for Neptune Page */
#neptune {
  padding: 20px;
}

.sound-buttons-container {
        max-width: 700px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin: auto;
    }

    .sound-btn {
        width: 150px;
        height: 50px;
        font-size: 1em;
        border-radius: 8px;
        transition: transform 0.2s, box-shadow 0.2s;
        font-weight: bold;
    }

    .sound-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    /* Playback Speed Selector */
    .playback-speed-container {
        margin-bottom: 20px;
    }

    #playback-speed {
        border-radius: 5px;
        padding: 5px;
        border: 1px solid #ccc;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    /* End Effect Button */
    .btn-danger {
        padding: 10px 20px;
        font-size: 1.2em;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(255, 0, 0, 0.2);
    }

#admin-search-bar {
    border-radius: 20px;
    padding: 10px;
}

.list-group-item {
    border: 1px solid #ccc;
    border-radius: 5px;
    margin-bottom: 10px;
}

.list-group-item:hover {
    background-color: #f8f9fa;
}

#scoring-trends {
    max-width: 100%;
    height: 300px !important; /* Prevents excessive height expansion */
    display: block;
    margin: auto;
}


#stats {
    padding: 20px;
}

.card {
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    background-color: white;
    text-align: center;
}

.card h4 {
    color: #007bff;
    font-weight: bold;
}

#scoring-trends {
    max-width: 100%;
    height: 300px;
}

.btn {
    border-radius: 5px;
    transition: transform 0.2s ease-in-out;
}

.btn:hover {
    transform: scale(1.05);
}


.message-popup {
    width: 400px;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.9);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}



/* Responsive Adjustments */
@media (max-width: 768px) {
  #title {
    padding: 10px;
  }

  .title-input {
    font-size: 0.9em;
  }

  .card {
    padding: 15px;
  }
}

.sidebar {
        background: linear-gradient(145deg, #1a237e, #0d47a1);
        backdrop-filter: blur(10px);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar a {
        margin: 8px 0;
        padding: 12px 20px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
    }


    /* Enhanced Message Cards */
    .message-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(5px);
        border-radius: 15px;
        border-left: 5px solid #0d47a1;
        padding: 20px;
        margin: 15px 0;
        transition: all 0.3s ease;
    }

    .message-card:hover {
        transform: translateX(5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    /* Enhanced Progress Bar */
    .progress {
        height: 10px;
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .progress-bar {
        transition: width 0.6s ease, background-color 0.3s ease;
    }

    /* Dark Mode Enhancements */
    body.dark-mode {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        color: #ffffff;
    }

    body.dark-mode .card {
        background: rgba(40, 40, 40, 0.9);
        border-color: rgba(255, 255, 255, 0.1);
    }

    body.dark-mode .form-control {
        background: rgba(30, 30, 30, 0.9);
        border-color: rgba(255, 255, 255, 0.1);
        color: #ffffff;
    }

    /* Loading Spinner Enhancement */
    .loading-spinner {
        backdrop-filter: blur(5px);
        background: rgba(0, 0, 0, 0.5);
    }

    /* Toast Enhancements */
    .toast {
        border-radius: 15px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }


/* Pagination Controls */
#pagination-controls .btn {
  border-radius: 20px;
  padding: 5px 15px;
  transition: background-color 0.3s ease;
}

#pagination-controls .btn:hover {
  background-color: #0056b3;
  color: #fff;
}


.btn-group button {
    margin: 5px;
    padding: 10px 20px;
    border-radius: 5px;
    transition: all 0.3s ease;
}

.btn-group button:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

/* Section Dividers */
.roster-controls, .standings {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #ffffff;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.info-section p {
    font-size: 0.9em;
    color: #777;
}


.sidebar a:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(5px);
    }

    /* Enhanced Cards */
    .card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
        border-radius: 20px;
        transition: all 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(31, 38, 135, 0.25);
    }

    /* Enhanced Buttons */
    .btn {
        border-radius: 10px;
        padding: 10px 20px;
        font-weight: 600;
        letter-spacing: 0.5px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .btn::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }

    .btn:hover::after {
        width: 200%;
        height: 200%;
    }

    /* Enhanced Score Display */
    .display-4 {
        font-size: 4rem;
        font-weight: 700;
        color: #1a237e;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .playoffs-banner {
        text-align: center;
        padding: 20px 0;
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
    }

    .playoffs-text {
        font-size: 4em;
        font-weight: 900;
        text-transform: uppercase;
        background: linear-gradient(45deg, #FFD700, #FFA500, #FF6B6B, #4CAF50, #5C6BC0);
        background-size: 400% 400%;
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        animation: gradientFlow 8s ease infinite,
                   bounce 2s ease-in-out infinite,
                   glow 2s ease-in-out infinite;
        position: relative;
        letter-spacing: 4px;
    }

    .playoffs-text::before {
        content: '';
        position: absolute;
        top: -10%;
        left: -10%;
        right: -10%;
        bottom: -10%;
        background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
        opacity: 0;
        animation: sparkle 4s ease-in-out infinite;
    }

    @keyframes gradientFlow {
        0% { background-position: 0% 50% }
        50% { background-position: 100% 50% }
        100% { background-position: 0% 50% }
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    @keyframes glow {
        0%, 100% { filter: drop-shadow(0 0 15px rgba(255,215,0,0.6)); }
        50% { filter: drop-shadow(0 0 25px rgba(255,215,0,0.8)); }
    }

    @keyframes sparkle {
        0%, 100% { opacity: 0; transform: scale(0.8); }
        50% { opacity: 1; transform: scale(1.1); }
    }

    /* Dark mode compatibility */
    body.dark-mode .playoffs-text {
        filter: brightness(1.2);
    }

    /* Enhanced Popups */
    .login-popup, .create-log-popup {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    }

    /* Enhanced Form Controls */
    .form-control {
        border-radius: 10px;
        border: 1px solid rgba(0, 0, 0, 0.1);
        padding: 12px;
        transition: all 0.3s ease;
    }

    .form-control:focus {
        box-shadow: 0 0 0 3px rgba(13, 71, 161, 0.25);
        border-color: #0d47a1;
    }

    .rainbow-outline-button {
    padding: 12px 24px;
    font-size: 16px;
    font-weight: 500;
    color: #000;
    background: white;
    border: 2px solid transparent;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
    z-index: 0;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.rainbow-outline-button::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(
        90deg,
        #ff0000,
        #ff8000,
        #ffff00,
        #00ff00,
        #00ffff,
        #0000ff,
        #8000ff,
        #ff0000
    );
    background-size: 200% 100%;
    z-index: -1;
    border-radius: 14px;
    animation: rainbow-border-shift 5s linear infinite;
}

.rainbow-outline-button::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    right: 2px;
    bottom: 2px;
    background: white;
    border-radius: 10px;
    z-index: -1;
}

.rainbow-outline-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

@keyframes rainbow-border-shift {
    0% {
        background-position: 0% 50%;
    }
    100% {
        background-position: 200% 50%;
    }
}



/* ==========================================================================
   Emergency Message
   ========================================================================== */
   MSG_EMER

   #homepageEmergencyContent { top: 0px !important; }

#emer-code-green{    padding-left: 3rem!important;     padding-right: 3rem!important;}
	.MSG_EMER h3, .MSG_EMER p {color: #04444e;}
.MSG_EMER h3 {  font-size:1.2em;  border-bottom:1px dotted #04444e;}
.MSG_EMER p {margin-bottom:10px;     line-height: 1.5em;}

		
		#emer-code-red .emr-color-box, #emer-code-red .emr-btn-color { background-color:#ba1e21; color:#fff } 
		#emer-code-red .emr-color-box h2 { color:#fff } 
		
		#emer-code-yellow .emr-color-box, #emer-code-yellow .emr-btn-color { background-color:#f5c500; color:#000!important;  } 
		#emer-code-yellow .emr-color-box h2 { color:#000 } 
		
			#emer-code-orange .emr-color-box, #emer-code-orange .emr-btn-color { background-color:#e97601; } 
		#emer-code-orange .emr-color-box h2 { color:#fff } 
			
		#emer-code-blue .emr-color-box, #emer-code-blue .emr-btn-color { background-color:#0068a7; color:#fff } 
		#emer-code-blue .emr-color-box h2 { color:#fff } 
		
			
		#emer-code-green .emr-color-box, #emer-code-green .emr-btn-color { background-color:#007356; } 
        #emer-code-green .emr-btn-color {  padding: 5px 10px;    font-size: 12px; color:#fff;} 
		#emer-code-green .emr-color-box h2 { color:#fff } 
		
			
		#emer-code-purple .emr-color-box, #emer-code-purple .emr-btn-color { background-color:#944f8e; color:#fff } 
		#emer-code-purple .emr-color-box h2 { color:#fff } 

		#emer-code-black .emr-color-box, #emer-code-black .emr-btn-color { background-color:#28282B; color:#fff } 
		#emer-code-black .emr-color-box h2 { color:#fff } 
		/*#msgBtn { display: none;}*/
        .emergency { display: none;} 


/* ==========================================================================
  Redesign 2023
   ========================================================================== */

#header .emergency{ display: none;} 
#header .emergency {background-color: #fff;}
	#header .MSG_EMER h3, .MSG_EMER p {color: #04444e;}
#header .MSG_EMER h3 {  font-size:1.2em;  border-bottom:1px dotted #04444e;}
#header .MSG_EMER p {margin-bottom:10px;  color: #04444e;    line-height: 1.5em;}


 
/* ==========================================================================
    Media Queries for Responsive Design.
   ========================================================================== */
@media only screen and (max-width:575.98px) {

	/* ==========================================================================
   END Redesign 2023
   ========================================================================== */

 .emergency{width:100%; margin:50px 0 0 0 ;padding:0; display:none;  background-color:#fff; }
.MSG_INFO {  background-color:#fff; overflow:hidden;display:block; }
	#homepageEmergencyContent{position:relative; top:0px;}
	
	#emer-code-green{    padding-left: 15px!important;     padding-right: 15px!important;}
}
 /*Small devices (landscape phones, 576px and up)*/
@media (min-width: 576px) and (max-width: 767.98px) {
	
.MSG_INFO { position:relative; top:50px;  background-color:#fff; overflow:hidden; }
	

body {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        transition: all 0.5s ease;
    }

    /* Enhanced Sidebar */
    
}

    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div class="overlay" id="login-overlay"></div>
<div class="login-popup" id="login-popup">
    <div class="login-card">
        <h2 class="login-title">Welcome Back</h2>
        <p class="login-subtitle">Please login to continue</p>
        <input type="email" id="login-email" class="form-control login-input" placeholder="Email" required />
        <input type="password" id="login-password" class="form-control login-input" placeholder="Password" required />
        <div class="login-actions">
            <button class="btn btn-primary" id="login-button">Login</button>
            <button class="btn btn-secondary" id="c" onclick="closeLoginPopup()">Cancel</button>
        </div>
        <div id="login-error" class="login-error" style="display: none;"></div>
    </div>
</div>

<div id="whats-new-popup" class="popup-overlay">
    <div class="popup-container">
      <div class="popup-header">
        <h2>What's New</h2>
        <button class="close-btn" onclick="closePopup()">Ã—</button>
      </div>
      <div class="popup-content">
        <ul>
            <li><i class="fas fa-paintbrush"></i> <strong>Scoreboard update:</strong> A new security system has been added</li>
          <li><i class="fas fa-road"></i> <strong>Years end:</strong> after trials of testing this year, the digital scoreboard system will no longer be used via this website, instead we are adding an api that will allow the database to be controlled on the product known as "Stream Deck."</li>
          <li><i class="fas fa-road"></i> <strong>Coming Soon:</strong> Revamped UI, API controller, stronger logs, audio system revamp- including playlists to replace Neptune Music</li>
        </ul>
      </div>
      <div class="popup-footer">
        <button class="btn-primary" onclick="closePopup()">Got it!</button>
      </div>
    </div>
  </div>
  
  


    <div class="sidebar">
        <img src="logo.png" alt="Winston Churchill High School Athletics" class="logo">
        <h2>Admin Dashboard</h2>
        <div id="connection-label">Checking connection...</div>
        <div id="current-time">Current Time: --:--</div>
        <div id="logins" class="text-white text-bottom" style="margin-top: 10px;">Loading User</div>
        <input type="text" id="sidebar-search" placeholder="Search..." class="form-control">
        <a href="#score" onclick="showTab('score')"><i class="fas fa-trophy"></i> Score Management</a>
        <a href="#title" onclick="showTab('title')"><i class="fas fa-edit"></i> Game Title</a>
        <a href="#stats" onclick="showTab('stats')"><i class="fas fa-chart-line"></i> Statistics</a>
        <a href="#logs" onclick="showTab('logs')"><i class="fas fa-book"></i> Logs</a>
        <a href="#ai" onclick="showTab('ai')"><i class="fas fa-robot"></i> AI Assistant</a>
        <a href="#info" onclick="showTab('info')"><i class="fas fa-info-circle"></i> Info</a>
        <a href="#settings" onclick="showTab('settings')"><i class="fas fa-cogs"></i> Settings</a>
        <a href="#admin" onclick="showTab('admin')"><i class="fas fa-users-cog"></i> Admin</a>
        <a href="#inbox" onclick="showTab('inbox')"><i class="fas fa-inbox"></i> Inbox</a>
        <a href="#roster" onclick="showTab('roster')"><i class="fas fa-users"></i> Rosters</a>
        <a href="#neptune" onclick="showTab('neptune')"><i class="fas fa-music"></i> Neptune</a>
        <a href="#guides" onclick="showTab('guides')"><i class="fas fa-book"></i> Guides</a>
        <button class="btn btn-primary" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>
    

    <div class="content">
        <h1>Winston Churchill High School Athletics Admin Dashboard</h1>
        

        
        

        <div id="inbox" class="tab-content fade">
            <h2 class="text-primary text-center">Inbox</h2>
          
            <!-- Search Bar -->
            <div class="form-group">
              <input
                type="text"
                id="search-messages"
                class="form-control search-bar"
                placeholder="Search messages..."
                oninput="filterMessages()"
              />
            </div>
          
            <!-- Message Container -->
            <div id="message-container" class="d-flex flex-column">
              <!-- Example Message Card -->
            </div>
          
            <!-- Pagination -->
            <div id="pagination-controls" class="mt-3 d-flex justify-content-center">
              <button class="btn btn-secondary mx-1" onclick="prevPage()">Previous</button>
              <button class="btn btn-secondary mx-1" onclick="nextPage()">Next</button>
            </div>
          </div>
          
        

          <div id="admin" class="tab-content admin-tab fade">
            <h2 class="text-primary text-center">User Management</h2>
        
            <!-- Search Bar -->
            <div class="form-group my-3">
                <input type="text" id="admin-search-bar" class="form-control search-bar" placeholder="Search users..." oninput="filterUsers()" />
            </div>
        
            <!-- Actions -->
            <div class="d-flex justify-content-between mb-3">
                <button class="btn btn-primary" onclick="openCreateUserPopup()"><i class="fas fa-user-plus"></i> Create User</button>
                <button class="btn btn-primary" onclick="openMessagePopup()"><i class="fas fa-user-plus"></i> Send Message</button>
                <button class="btn btn-danger" onclick="bulkDeleteUsers()"><i class="fas fa-trash"></i> Delete Selected</button>
                <button class="btn btn-secondary" onclick="sendMessageToSelected()"><i class="fas fa-envelope"></i> Message Selected</button>
            </div>
        
            <!-- User List -->
            <div id="user-list-container" class="list-group">
                <!-- Dynamic User List will be populated here -->
            </div>
        
            <!-- Pagination -->
            <div id="admin-pagination-controls" class="mt-3 d-flex justify-content-center">
                <button class="btn btn-secondary mx-1" onclick="prevUserPage()">Previous</button>
                <button class="btn btn-secondary mx-1" onclick="nextUserPage()">Next</button>
            </div>
        </div>
        
        <!-- Create User Popup -->
        <div id="create-user-popup" class="message-popup" style="display:none;">
            <h3>Create User</h3>
            <input type="email" id="new-user-email" class="form-control" placeholder="Email" required />
            <input type="password" id="new-user-password" class="form-control my-2" placeholder="Password" required />
            <select id="new-user-role" class="form-control my-2">
                <option value="Admin">Admin</option>
                <option value="Editor">Editor</option>
                <option value="Viewer">Viewer</option>
            </select>
            <button class="btn btn-success" onclick="createUser()">Create</button>
            <button class="btn btn-secondary" onclick="closeCreateUserPopup()">Cancel</button>
        </div>
        
        <!-- Message Popup -->
        <div id="message-popup" class="message-popup" style="display:none;">
            <h3>Send Message</h3>
            <textarea id="popup-message-input" class="form-control" placeholder="Type your message here..."></textarea>
            <input type="file" id="popup-attachment-input" class="form-control mt-2" accept="image/*" />
            <button class="btn btn-success my-2" onclick="sendMessage()">Send</button>
            <button class="btn btn-secondary" onclick="closeMessagePopup()">Cancel</button>
        </div>
        

<!-- Message Popup -->



        <div id="score" class="tab-content fade show">
            <h2>Score Management</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="card shadow p-4 mb-3">
                        <h3 class="text-primary text-center">Home Team</h3>
                        <p class="display-4 text-center font-weight-bold" id="home-score">0</p>
                        <div class="btn-group d-flex justify-content-center">
                            <button class="btn btn-success mx-1" onclick="updateScore('home', 1)"><i class="fas fa-plus-circle"></i> +1</button>
                            <button class="btn btn-success mx-1" onclick="updateScore('home', 2)"><i class="fas fa-plus-circle"></i> +2</button>
                            <button class="btn btn-success mx-1" onclick="updateScore('home', 3)"><i class="fas fa-plus-circle"></i> +3</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('home', -1)"><i class="fas fa-minus-circle"></i> -1</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('home', -2)"><i class="fas fa-minus-circle"></i> -2</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('home', -3)"><i class="fas fa-minus-circle"></i> -3</button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card shadow p-4 mb-3">
                        <h3 class="text-primary text-center">Away Team</h3>
                        <p class="display-4 text-center font-weight-bold" id="away-score">0</p>
                        <div class="btn-group d-flex justify-content-center">
                            <button class="btn btn-success mx-1" onclick="updateScore('away', 1)"><i class="fas fa-plus-circle"></i> +1</button>
                            <button class="btn btn-success mx-1" onclick="updateScore('away', 2)"><i class="fas fa-plus-circle"></i> +2</button>
                            <button class="btn btn-success mx-1" onclick="updateScore('away', 3)"><i class="fas fa-plus-circle"></i> +3</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('away', -1)"><i class="fas fa-minus-circle"></i> -1</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('away', -2)"><i class="fas fa-minus-circle"></i> -2</button>
                            <button class="btn btn-danger mx-1" onclick="updateScore('away', -3)"><i class="fas fa-minus-circle"></i> -3</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Home Team Fouls -->
                <div class="col-md-6">
                    <div class="card shadow p-4 mb-3">
                        <h3 class="text-primary text-center">Home Team Fouls</h3>
                        <p class="display-4 text-center font-weight-bold" id="home-fouls">0</p>
                        <div class="btn-group d-flex justify-content-center">
                            <button class="btn btn-success mx-1" onclick="updateFouls('home', 1)"><i class="fas fa-plus-circle"></i> +1</button>
                            <button class="btn btn-danger mx-1" onclick="updateFouls('home', -1)"><i class="fas fa-minus-circle"></i> -1</button>
                        </div>
                    </div>
                </div>
                <!-- Away Team Fouls -->
                <div class="col-md-6">
                    <div class="card shadow p-4 mb-3">
                        <h3 class="text-primary text-center">Away Team Fouls</h3>
                        <p class="display-4 text-center font-weight-bold" id="away-fouls">0</p>
                        <div class="btn-group d-flex justify-content-center">
                            <button class="btn btn-success mx-1" onclick="updateFouls('away', 1)"><i class="fas fa-plus-circle"></i> +1</button>
                            <button class="btn btn-danger mx-1" onclick="updateFouls('away', -1)"><i class="fas fa-minus-circle"></i> -1</button>
                        </div>
                    </div>
                </div>
            </div>
            
            
            <div class="card shadow p-4 mb-4">
                <div class="form-group text-center">
                    <label for="quarter" class="font-weight-bold">Quarter:</label>
                    <select id="quarter" class="form-control w-50 mx-auto" onchange="updateQuarterAndProgress()">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
            </div>
            
            <div class="card shadow p-4">
                <div class="d-flex justify-content-around">
                    <button class="btn btn-info" onclick="logScore()">Log Score</button>
                    <button class="btn btn-danger" onclick="clearScores()">Clear Scores</button>
                    <button class="btn btn-warning" onclick="endGame()">End Game</button>
                    <button class="btn btn-secondary" onclick="infopopup(`This feature is currently disabled`)">Projector Mode</button>
                    <button class="btn btn-primary" onclick="infopopup(`This feature is currently disabled`)">Generate AI Summary</button>
                </div>
            </div>

            <div id="game-summary-container" class="mt-4">
                <h3>Game Summary</h3>
                <p id="game-summary" class="text-muted">Click "Generate AI Summary" to analyze the game.</p>
            </div>

            <div class="progress mt-4">
                <div id="score-progress" class="progress-bar bg-primary" role="progressbar" style="width: 25%" aria-valuenow="1" aria-valuemin="0" aria-valuemax="4"></div>
            </div>
        </div>

        <div id="title" class="tab-content fade">
            <h2 class="text-primary text-center">Game Title Management</h2>
          
            <!-- Game Title Section -->
            <div class="form-group mt-4">
              <label for="game-title" class="font-weight-bold">Game Title:</label>
              <input
                type="text"
                id="game-title"
                class="form-control title-input"
                placeholder="Enter game title"
                oninput="updateGameDetails('gameTitle', this.value)"
              />
            </div>
          
            <!-- Away Team Name -->
            <div class="form-group mt-4">
              <label for="away-team-name" class="font-weight-bold">Away Team Name:</label>
              <input
                type="text"
                id="away-team-name"
                class="form-control title-input"
                placeholder="Enter Away Team Name"
                oninput="updateGameDetails('awayTeam', this.value)"
              />
            </div>
          
            <!-- Home Team Name -->
            <div class="form-group mt-4">
              <label for="home-team-name" class="font-weight-bold">Home Team Name:</label>
              <input
                type="text"
                id="home-team-name"
                class="form-control title-input"
                placeholder="Enter Home Team Name"
                oninput="updateGameDetails('homeTeam', this.value)"
              />
            </div>
          
            <!-- Preview of Game Details -->
            <div class="card mt-4 p-4 shadow">
              <h4 class="text-center text-success">Preview</h4>
              <p><strong>Game Title:</strong> <span id="preview-game-title">Not Set</span></p>
              <p><strong>Home Team:</strong> <span id="preview-home-team">Not Set</span></p>
              <p><strong>Away Team:</strong> <span id="preview-away-team">Not Set</span></p>
            </div>
          </div>
          

          <div id="stats" class="tab-content fade show">
            <h2 class="text-center text-primary mb-4">Game Statistics</h2>
        
            <!-- Scoring Chart -->
            <div class="card shadow p-4">
                <h4 class="text-center text-success">Scoring Trends</h4>
                <canvas id="scoring-trends"></canvas>
                
                <!-- Export Buttons -->
                <div class="text-center mt-3">
                    <button class="btn btn-primary mx-2" onclick="exportChart('png')">
                        <i class="fas fa-download"></i> Download as PNG
                    </button>
                    <button class="btn btn-danger mx-2" onclick="exportChart('pdf')">
                        <i class="fas fa-file-pdf"></i> Save as PDF
                    </button>
                </div>
            </div>
        
            <!-- Visitor Count -->
            <div class="card shadow mt-4 p-3">
                <h4><i class="fas fa-users"></i> Active Visitors</h4>
                <p id="active-visitors" class="font-weight-bold text-center text-primary">0</p>
            </div>
        </div>
        

        <div id="logs" class="tab-content fade" style="display:none;">
            <h2>Game Logs</h2>
            <div class="form-group">
                <input type="text" id="search-bar" class="form-control search-bar" placeholder="Search logs..." oninput="filterLogs()">
            </div>
            <div id="game-logs-container" class="log-list">
                <!-- Logs will be dynamically populated here -->
            </div>
            <div id="pagination" class="mt-3"></div> <!-- Pagination controls -->
            <div class="log-controls">
                <button class="btn btn-primary" onclick="exportLogsToPDF()">Export to PDF</button>
                <button class="btn btn-secondary" onclick="exportLogsToCSV()">Export to CSV</button>
                <button class="btn btn-secondary" onclick="exportLogsToExcel()">Export to Excel</button>
                <button class="btn btn-danger" onclick="bulkDeleteLogs()">Delete Selected Logs</button>
            </div>
        </div>
        

        <div id="ai" class="tab-content fade" style="display:none;">
            <h2 class="ai-title">AI Assistant</h2>
            <div class="ai-container">
                <p class="ai-description">Ask your question below, and the AI assistant will provide guidance.</p>
                <div class="ai-input-group">
                    <input type="text" id="ai-question" class="form-control ai-input" placeholder="Enter your question here..." />
                    <button class="btn btn-primary ai-submit" onclick="askAI()">Ask AI</button>
                </div>
                <div id="ai-response" class="ai-response">
                    <p class="ai-placeholder">Your response will appear here...</p>
                </div>
            </div>
        </div>

        <div id="neptune" class="tab-content fade">
            <h2 class="text-primary text-center">Neptune Sound Effects</h2>
            <p class="text-center text-muted">Click a button to play a sound effect. Only one effect can be played at a time.</p>
        
            <!-- Playback Speed Selector -->
            <div class="playback-speed-container text-center my-3">
                <label for="playback-speed" class="font-weight-bold">Playback Speed:</label>
                <select id="playback-speed" class="form-control w-50 mx-auto">
                    <option value="0.5">0.5x</option>
                    <option value="1" selected>1x</option>
                    <option value="1.5">1.5x</option>
                    <option value="2">2x</option>
                </select>
            </div>
        
            <!-- Sound Effect Buttons -->
            <div class="sound-buttons-container d-flex flex-wrap justify-content-center">
                <button class="btn btn-primary sound-btn m-2">Home Depot Theme Song</button>
                <button class="btn btn-primary sound-btn m-2">Airhorn</button>
                <button class="btn btn-primary sound-btn m-2">Effect 3</button>
                <button class="btn btn-primary sound-btn m-2">Effect 4</button>
                <button class="btn btn-primary sound-btn m-2">Effect 5</button>
                <button class="btn btn-primary sound-btn m-2">Effect 6</button>
                <button class="btn btn-primary sound-btn m-2">Effect 7</button>
                <button class="btn btn-primary sound-btn m-2">Effect 8</button>
                <button class="btn btn-primary sound-btn m-2">Effect 9</button>
                <button class="btn btn-primary sound-btn m-2">Effect 10</button>
                <button class="btn btn-primary sound-btn m-2">Effect 11</button>
                <button class="btn btn-primary sound-btn m-2">Effect 12</button>
            </div>
        
            <!-- End Sound Effect Button -->
            <div class="text-center mt-4">
                <button class="btn btn-danger">End Effect</button>
            </div>
        </div>
          

        <div id="info" class="tab-content fade" style="display:none;">
            <h2>Info</h2>
            <header id="header">
                <div id="homepageEmergencyContent">
            
                </div>
            </header>
            <button class="rainbow-outline-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 4a4 4 0 014 4 4 4 0 01-4 4 4 4 0 01-4-4 4 4 0 014-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4z"/>
                </svg>
                Button Test
            </button>
            <button class="btn btn-warning" onclick="testWeatherAlert()">
                <i class="fas fa-cloud-bolt"></i> Test Weather Alert
            </button>
            <div class="info-section">
                <p>Copyright Â© WCHS Athletics 2025</p>
                <p>APIs Powered By <img src="https://assets.vnnsports.net/2021/01/14133922/vnn-logo-blackwhiteoutline.png" alt="VNN API" style="height: 30px;"> <img src="rschool.png" alt="VNN API" style="height: 100px;"></p>
            </div>
        </div>

        <div id="roster" class="tab-content fade" style="display:none;">
            <h2 class="text-center text-primary">Team Rosters</h2>
            <div class="roster-controls my-4 text-center">
                <select id="rosterchange" class="form-control w-50 mx-auto" onchange="rostercheck()">
                    <option value="1">Albert Einstein</option>
                    <option value="2">Bethesda-Chevy Chase</option>
                    <option value="4">Col. Zadok Magruder</option>
                    <option value="5">Damascus</option>
                    <option value="7">James Hubert Blake</option>
                    <option value="12">Paint Branch</option>
                    <option value="14">Quince Orchard</option>
                    <option value="19">Springbrook</option>
                    <option value="25">Thomas S. Wootton</option>
                    <option value="20">Walt Whitman</option>
                    <option value="21">Walter Johnson</option>
                    <option value="22">Watkins Mill</option>
                    <option value="24">Winston Churchill</option>
                </select>
            </div>
        
            <div class="text-center my-4">
                <h4>Select a Team Category:</h4>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="jvb()">JV Boys Basketball</button>
                    <button class="btn btn-primary" onclick="vb()">Varsity Boys Basketball</button>
                    <button class="btn btn-primary" onclick="jvg()">JV Girls Basketball</button>
                    <button class="btn btn-primary" onclick="vg()">Varsity Girls Basketball</button>
                </div>
            </div>
        
            <div class="standings text-center my-4">
                <h4>View Standings:</h4>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="standingsjvboysbasketball()">JV Boys Basketball Standings</button>
                    <button class="btn btn-secondary" onclick="standingsvboysbaketball()">Varsity Boys Basketball Standings</button>
                    <button class="btn btn-secondary" onclick="standingsjvgirlsbasketball()">JV Girls Basketball Standings</button>
                    <button class="btn btn-secondary" onclick="standingsvgirlsbaketball()">Varsity Girls Basketball Standings</button>
                </div>
            </div>
        
        </div>
        

        <div id="settings" class="tab-content fade" style="display:none;">
            <h2>Settings</h2>
            <div class="card shadow mb-3 p-3">
                <h4><i class="fas fa-adjust"></i> Appearance</h4>
                <div class="d-flex align-items-center mb-3">
                    <span class="mr-3">Dark Mode:</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="form-group">
                    <label for="theme-select"><i class="fas fa-palette"></i> Select Theme:</label>
                    <select id="theme-select" class="form-control">
                        <option value="default">Default</option>
                        <option value="blue">Blue</option>
                        <option value="green">Green</option>
                        <option value="red">Red</option>
                    </select>
                </div>
            </div>
        </div>
        

        <div class="overlay" id="create-user-overlay"></div>
        <div class="create-user-popup" id="create-user-popup" style="display: none;">
            <h2>Create User</h2>
            <input type="email" id="new-user-email" class="form-control" placeholder="Email" required />
            <input type="password" id="new-user-password" class="form-control" placeholder="Password" required />
            <button class="btn btn-success" onclick="createUser()">Create User</button>
            <button class="btn btn-secondary" onclick="closeCreateUserPopup()">Cancel</button>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="login-popup" id="create-log-popup">
        <h2>Create Log</h2>
        <div class="form-group">
            <label for="log-game">Game:</label>
            <input type="text" id="log-game" class="form-control" placeholder="Enter game name">
        </div>
        <div class="form-group">
            <label for="log-home-score">Home Score:</label>
            <input type="number" id="log-home-score" class="form-control" placeholder="Enter home score">
        </div>
        <div class="form-group">
            <label for="log-away-score">Away Score:</label>
            <input type="number" id="log-away-score" class="form-control" placeholder="Enter away score">
        </div>
        <button class="btn btn-success" onclick="createLog()">Create Log</button>
        <button class="btn btn-secondary" onclick="closeCreateLogPopup()">Cancel</button>
    </div>

    <div class="loading-spinner" id="loading-spinner">
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>

    <div id="projector-mode" class="projector-mode">
        <div>
            <span id="projector-score">Score: 0 - 0</span>
            <br>
            <span id="projector-quarter">Quarter: 1</span>
        </div>
    </div>

    <script  src="https://cdn.jsdelivr.net/npm/brain.js"></script>



    <script>

//showMaintenancePopup();


getAPIdata();





  function errorpopup(error) {
    new Notify ({
    status: 'error',
    title: 'Error',
    text: error,
    effect: 'fade',
    speed: 300,
    customClass: 'swal2-container',
    customIcon: '',
    showIcon: true,
    showCloseButton: true,
    autoclose: true,
    autotimeout: 3000,
    notificationsGap: null,
    notificationsPadding: null,
    type: 'outline',
    position: 'right top',
    customWrapper: '',
  })
  }

  function successpopup(error) {
    new Notify ({
    status: 'success',
    title: 'Success',
    text: error,
    effect: 'fade',
    speed: 300,
    customClass: 'swal2-container',
    customIcon: '',
    showIcon: true,
    showCloseButton: true,
    autoclose: true,
    autotimeout: 3000,
    notificationsGap: null,
    notificationsPadding: null,
    type: 'outline',
    position: 'right top',
    customWrapper: '',
  })
  }

  function infopopup(error) {
    new Notify ({
    status: 'info',
    title: 'Info',
    text: error,
    effect: 'fade',
    speed: 300,
    customClass: 'glass',
    customIcon: '',
    showIcon: true,
    showCloseButton: true,
    autoclose: true,
    autotimeout: 3000,
    notificationsGap: null,
    notificationsPadding: null,
    type: 'outline',
    position: 'right top',
    customWrapper: '',
  })
  }




        let currentroster = 1
        let rosterenabled = false
        let loginscreen = true

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBLknke4IwRj2g0zqsp6CDZxDDxePY3qI8",
            authDomain: "test-71ecd.firebaseapp.com",
            databaseURL: "https://test-71ecd-default-rtdb.firebaseio.com",
            projectId: "test-71ecd",
            storageBucket: "test-71ecd.firebasestorage.app",
            messagingSenderId: "426214403781",
            appId: "1:426214403781:web:4af409ec8186bd821d4aac",
            measurementId: "G-C7VBNTXM8R"
        };

       


        // Initialize the neural network
let net; // Declare net globally

        $(document).ready(() => {
            // Initialize the neural network
            net = new brain.NeuralNetwork();

            // Training data for brain.js
           const trainingData = [
    { input: { question: "What is the score?" }, output: { answer: "The current score is 0 - 0." } },
    { input: { question: "How do I log a score?" }, output: { answer: "To log a score, click the Log Score button." } },
    { input: { question: "What is the current quarter?" }, output: { answer: "The current quarter is 1." } },
    { input: { question: "How do I change the team name?" }, output: { answer: "You can change the team name in the Game Title tab." } },
    { input: { question: "What is the AI assistant?" }, output: { answer: "The AI assistant helps you navigate the dashboard." } },
    { input: { question: "How do I clear scores?" }, output: { answer: "Click the Clear Scores button in the Score tab." } },
    { input: { question: "How do I view past games?" }, output: { answer: "You can view past games in the Logs tab." } },
    { input: { question: "What themes are available?" }, output: { answer: "You can choose from blue, green, red, or default themes." } },
    { input: { question: "How do I enable dark mode?" }, output: { answer: "Toggle the dark mode switch in the Settings tab." } },
    { input: { question: "What is the purpose of the dashboard?" }, output: { answer: "The dashboard is designed to manage athletics events and scores." } },
    // Add more scenarios as needed
];

            // Train the network
            net.train(trainingData);
        });

// Training data for brain.js
   //         net.train(trainingData);


// Train the network


let scoringTrendsChart;

// Function to initialize the scoring trends graph
function initScoringTrends() {
    const ctx = document.getElementById('scoring-trends').getContext('2d');
    scoringTrendsChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [
                {
                    label: 'Home Team',
                    data: [],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false
                },
                {
                    label: 'Away Team',
                    data: [],
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    fill: false
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, /* Prevents auto-stretching */
            scales: {
                y: { beginAtZero: true }
            },
            layout: {
                padding: {
                    left: 10, right: 10, top: 10, bottom: 10
                }
            }
        }
    });
}


// Function to update the chart with scores
function updateScoringChart(homeScore, awayScore, timeLabel) {
    scoringTrendsChart.data.labels.push(timeLabel);
    scoringTrendsChart.data.datasets[0].data.push(homeScore);
    scoringTrendsChart.data.datasets[1].data.push(awayScore);
    scoringTrendsChart.update();
}

// Function to export chart
function exportChart(format) {
    const canvas = document.getElementById('scoring-trends');

    if (format === 'png') {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = 'scoring_chart.png';
        link.click();
    } else if (format === 'pdf') {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();
        pdf.text('Game Scoring Chart', 10, 10);
        pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 10, 20, 180, 90);
        pdf.save('scoring_chart.pdf');
    }
}

// Initialize the chart when the page loads
document.addEventListener('DOMContentLoaded', initScoringTrends);


function jvb() {
    if (rosterenabled == false) {
        errorpopup("Roster Not Available");
        return;
    }
    nw=window.open(`https://montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=1546&school_id=${currentroster}&activity_63_34_2=http://apache-perl:10771/g5-bin/client.cgi?G5genie=2031;G5button=15&ffAdditionalInfo=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function vb() {
    if (rosterenabled == false) {
        errorpopup("Roster Not Available");
        return;
    }
    nw=window.open(`https://montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=1546&school_id=${currentroster}&activity_63_35_2=Basketball%20Boys%20Varsity&ffAdditionalInfo=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function jvg() {
    if (rosterenabled == false) {
        errorpopup("Roster Not Available");
        return;
    }
    nw=window.open(`https://montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=1546&school_id=${currentroster}&activity_63_34_3=Basketball%20Girls%20JV&ffAdditionalInfo=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function vg() {
    if (rosterenabled == false) {
       errorpopup("Roster Not Available");
        return;
    }
    nw=window.open(`https://montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=1546&school_id=${currentroster}&activity_63_35_3=Basketball%20Girls%20Varsity&ffAdditionalInfo=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function standingsjvboysbasketball() {
    nw=window.open(`https://www.montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=47&name_63_2_34_166_=Winter%202024-25%20Boys%20JV%20Basketball%20%20&school_id=${currentroster}&vw_agl=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function standingsjvgirlsbasketball() {
    nw=window.open(`https://www.montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=47&name_63_3_34_166_=Winter%202024-25%20Girls%20JV%20Basketball%20%20&school_id=${currentroster}&vw_agl=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function standingsvboysbaketball() {
    nw=window.open(`https://www.montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=47&name_63_2_35_166=Winter+2024-25+Boys+Varsity+Basketball&school_id=${currentroster}&vw_agl=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function standingsvgirlsbaketball() {
    nw=window.open(`https://www.montgomeryschoolsmdcalendar.org/g5-bin/client.cgi?G5genie=2031&cwellOnly=1&G5button=47&name_63_3_35_166=Winter+2024-25+Girls+Varsity+Basketball&school_id=${currentroster}&vw_agl=1`, "_blank", "width=500,height=500");
    nw.focus;
}

function showBan() {
    Swal.fire({
    title: 'Banned',
    text: 'You have been banned from accessing this platform.',
    iconHtml: '<img src="https://cdn-icons-png.flaticon.com/512/7641/7641419.png" style="width: 50px; height: 50px;" alt="Gavel Icon">',
    customClass: {
      popup: 'swal2-blur-background',
    },
    showConfirmButton: false,
    allowOutsideClick: false,
    allowEscapeKey: false,
    allowEnterKey: false
  });
}

// Initialize Firebase configuration (already in your project)
const firebaseDatabaseURL = "https://test-71ecd-default-rtdb.firebaseio.com";

// Game details object to store input values dynamically
const gameDetails = {
  gameTitle: "Not Set",
  homeTeam: "Not Set",
  awayTeam: "Not Set",
};

// Function to update game details dynamically
function updateGameDetails(key, value) {
  gameDetails[key] = value.trim() || "Not Set";

  // Update the preview section dynamically
  document.getElementById("preview-game-title").textContent = gameDetails.gameTitle;
  document.getElementById("preview-home-team").textContent = gameDetails.homeTeam;
  document.getElementById("preview-away-team").textContent = gameDetails.awayTeam;

  // Save the updated details to the Firebase database
  saveGameDetailsToDatabase();
}

// Function to save game details to Firebase
function saveGameDetailsToDatabase() {
  fetch(`${firebaseDatabaseURL}/gameDetails.json`, {
    method: "PUT",
    body: JSON.stringify(gameDetails),
    headers: {
      "Content-Type": "application/json",
    },
  })
    .then((response) => response.json())
    .then(() => {
      console.log("Game details saved successfully!");
     // showToast({ message: "Game details updated!", type: "success", duration: 3000 });
    })
    .catch((error) => console.error("Error saving game details:", error));
}

// Function to load game details from Firebase on page load
function loadGameDetails() {
  fetch(`${firebaseDatabaseURL}/gameDetails.json`)
    .then((response) => response.json())
    .then((data) => {
      if (data) {
        // Update the gameDetails object and preview section with fetched data
        gameDetails.gameTitle = data.gameTitle || "Not Set";
        gameDetails.homeTeam = data.homeTeam || "Not Set";
        gameDetails.awayTeam = data.awayTeam || "Not Set";

        // Populate input fields with loaded data
        document.getElementById("game-title").value = gameDetails.gameTitle !== "Not Set" ? gameDetails.gameTitle : "";
        document.getElementById("home-team-name").value = gameDetails.homeTeam !== "Not Set" ? gameDetails.homeTeam : "";
        document.getElementById("away-team-name").value = gameDetails.awayTeam !== "Not Set" ? gameDetails.awayTeam : "";

        // Update the preview section
        updateGameDetails("gameTitle", gameDetails.gameTitle);
        updateGameDetails("homeTeam", gameDetails.homeTeam);
        updateGameDetails("awayTeam", gameDetails.awayTeam);
      } else {
        console.log("No existing game details found.");
      }
    })
    .catch((error) => console.error("Error loading game details:", error));
}

// Load game details when the page is fully loaded
document.addEventListener("DOMContentLoaded", loadGameDetails);


function rostercheck() {
    const roosters = parseInt(document.getElementById('rosterchange').value, 10);
    if (roosters == 1) {
        rosterenabled = true
        currentroster = 1
      }  else if (roosters == 2) {
        rosterenabled = true
            currentroster = 2
        } else if (roosters == 4) {
            rosterenabled = true
            currentroster = 4
        } else if (roosters == 5) {
            rosterenabled = true
            currentroster = 5
        } else if (roosters == 7) {
            rosterenabled = true
            currentroster = 7
        } else if (roosters == 12) {
            rosterenabled = false
            currentroster = 12
        } else if (roosters == 14) {
            rosterenabled = true
            currentroster = 14
        } else if (roosters == 19) {
            rosterenabled = true
            currentroster = 19
        } else if (roosters == 25) {
            rosterenabled = true
            currentroster = 25
        } else if (roosters == 20) {
            rosterenabled = true
            currentroster = 20
        } else if (roosters == 21) {
            rosterenabled = true
            currentroster = 21
        } else if (roosters == 22) {
            rosterenabled = true
            currentroster = 22
        } else if (roosters == 24) {
            rosterenabled = true
            currentroster = 24
        }
}


function updateQuarterAndProgress() {
        const quarter = parseInt(document.getElementById('quarter').value, 10);
        const progressPercentage = (quarter / 4) * 100;

        const progressBar = document.getElementById('score-progress');
        progressBar.style.width = `${progressPercentage}%`;
        progressBar.setAttribute('aria-valuenow', quarter);

        if (quarter === 4) {
            progressBar.className = 'progress-bar bg-success';
        } else if (quarter === 3) {
            progressBar.className = 'progress-bar bg-warning';
        } else {
            progressBar.className = 'progress-bar bg-primary';
        }
    }

function showToast({ message, type = "success", duration = 5000 }) {
    const toastContainer = document.getElementById("toast-container");

    // Create a new toast element
    const toast = document.createElement("div");
    toast.className = `toast ${type}`;
    toast.innerHTML = `
        <span>${message}</span>
        <button class="close-btn">&times;</button>
    `;

    // Append the toast to the container
    toastContainer.appendChild(toast);

    // Remove the toast after the duration + fadeOut time
    const fadeOutDuration = 500; // Match the fadeOut animation duration in CSS
    setTimeout(() => {
        toast.style.animation = `fadeOut ${fadeOutDuration}ms ease forwards`;
        toast.addEventListener("animationend", () => toast.remove());
    }, duration);

    // Add close button functionality
    toast.querySelector(".close-btn").onclick = () => {
        toast.style.animation = `fadeOut ${fadeOutDuration}ms ease forwards`;
        toast.addEventListener("animationend", () => toast.remove());
    };
}

let currentAudio = null; // To track the currently playing sound
let isPlaying = false; // Prevent concurrent playback

// Function to play a sound effect
function playSoundEffect(effectValue) {
  if (isPlaying) {
    alert("A sound effect is already playing. Please wait for it to finish or press 'End Effect'.");
    return;
  }

  // Prevent concurrent playback
  isPlaying = true;

  // Map effectValue to a sound file
  const soundMap = {
    1: "sounds/effect1.mp3",
    2: "sounds/effect2.mp3",
    3: "sounds/effect3.mp3",
    4: "sounds/effect4.mp3",
    5: "sounds/effect5.mp3",
    6: "sounds/effect6.mp3",
    7: "sounds/effect7.mp3",
    8: "sounds/effect8.mp3",
    9: "sounds/effect9.mp3",
    10: "sounds/effect10.mp3",
    11: "sounds/effect11.mp3",
    12: "sounds/effect12.mp3",
  };

  const soundFile = soundMap[effectValue];
  if (!soundFile) {
    console.error("Invalid sound effect value:", effectValue);
    isPlaying = false;
    return;
  }

  // Create audio element
  currentAudio = new Audio(soundFile);

  // Get playback speed
  const playbackSpeed = parseFloat(document.getElementById("playback-speed").value);
  currentAudio.playbackRate = playbackSpeed;

  // Add fade-in effect
  currentAudio.volume = 0;
  const fadeDuration = 2000; // 2 seconds
  const fadeInterval = setInterval(() => {
    if (currentAudio && currentAudio.volume < 1) {
      currentAudio.volume = Math.min(currentAudio.volume + 0.05, 1);
    } else {
      clearInterval(fadeInterval);
    }
  }, fadeDuration / 20);

  // Play sound
  currentAudio.play();

  // Add fade-out effect and reset state
  currentAudio.addEventListener("ended", () => {
    const fadeOutInterval = setInterval(() => {
      if (currentAudio && currentAudio.volume > 0) {
        currentAudio.volume = Math.max(currentAudio.volume - 0.05, 0);
      } else {
        clearInterval(fadeOutInterval);
        isPlaying = false;
        currentAudio = null;
      }
    }, fadeDuration / 20);
  });

  // Handle error or interruption during playback
  currentAudio.addEventListener("error", () => {
    console.error("Error playing sound effect.");
    isPlaying = false;
    currentAudio = null;
  });
}

// Function to stop the current sound
function stopCurrentSound() {
  if (currentAudio) {
    currentAudio.pause();
    currentAudio.currentTime = 0; // Reset playback position
    currentAudio = null;
    isPlaying = false;
    console.log("Current sound effect stopped.");
  } else {
    console.log("No sound is currently playing.");
  }
}



// Example usage:
  //  showToast({ message: "Success notification!", type: "success", duration: 3000 });
 //   showToast({ message: "Error notification!", type: "error", duration: 4000 });
   // showToast({ message: "Warning notification!", type: "warning", duration: 2000 });

   // Add this after your existing scripts

function checkWeatherAlerts() {
    const WEATHER_API_KEY = '9102519a20d8f93f280d7c0d6eb7ba5b'; // Replace with your API key
    const POTOMAC_LAT = '39.0181';
    const POTOMAC_LON = '-77.2086';
    
    fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${POTOMAC_LAT}&lon=${POTOMAC_LON}&exclude=minutely,hourly,daily&appid=${WEATHER_API_KEY}`)
        .then(response => response.json())
        .then(data => {
            if (data.alerts && data.alerts.length > 0) {
                showWeatherAlert(data.alerts[0]);
            }
        })
        .catch(error => console.error('Error fetching weather data:', error));
}

function showWeatherAlert(alertData) {
    const alertContainer = document.createElement('div');
    alertContainer.className = 'weather-alert-container';
    
    alertContainer.innerHTML = `
        <div class="weather-alert-content">
            <i class="fas fa-exclamation-triangle fa-3x"></i>
            <h2>Weather Alert</h2>
            <p>${alertData.event}</p>
            <p>${alertData.description}</p>
        </div>
    `;
    
    document.body.appendChild(alertContainer);
    
    setTimeout(() => {
        alertContainer.remove();
    }, 10000);
}

// Test function for the weather alert
function testWeatherAlert() {
    const testAlertData = {
        event: "Severe Thunderstorm Warning",
        description: "The National Weather Service has issued a severe thunderstorm warning for Potomac, Maryland. Expect heavy rain, strong winds, and possible hail. Take necessary precautions."
    };
    showWeatherAlert(testAlertData);
}

// Add this to your existing styles
const weatherAlertStyles = document.createElement('style');
weatherAlertStyles.textContent = `
    .weather-alert-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.95);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.5s ease-in-out;
        animation: fadeOut 0.5s ease-in-out;
    }

    .weather-alert-content {
        text-align: center;
        padding: 2rem;
        border-radius: 10px;
        max-width: 600px;
        background: white;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }

    .weather-alert-content i {
        color: #ff9800;
        margin-bottom: 1rem;
    }

    .weather-alert-content h2 {
        color: #d32f2f;
        margin-bottom: 1rem;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
    }
`;
document.head.appendChild(weatherAlertStyles);

// Add this button to your HTML where needed


   function uploadImageToFirebase(file, callback) {
    const storageBucketURL = "https://firebasestorage.googleapis.com/v0/b/test-71ecd.appspot.com/o";
    const token = localStorage.getItem('token'); // Ensure the user is authenticated and the token is available

    const formData = new FormData();
    formData.append("file", file);

    $.ajax({
        url: `${storageBucketURL}/messages%2F${encodeURIComponent(file.name)}?uploadType=media`,
        type: "POST",
        headers: {
            "Authorization": `Bearer ${token}`,
            "Content-Type": file.type
        },
        data: file,
        processData: false,
        success: function (response) {
            const downloadURL = `${storageBucketURL}/messages%2F${encodeURIComponent(file.name)}?alt=media&token=${response.downloadTokens}`;
            callback(downloadURL); // Return the image URL via the callback
        },
        error: function (error) {
            console.error("Error uploading image:", error);
            alert("Image upload failed. Please try again.");
        }
    });
}


// Function to update the scoring trends


$(document).ready(() => {
    initScoringTrends(); 
});

        function sendMessage() {
    const message = document.getElementById("message-input").value.trim();
    if (message === "") {
        alert("Message cannot be empty.");
        return;
    }

    const messageData = {
        sender: "System", // Default sender
        content: message,
        timestamp: new Date().toISOString()
    };

    $.ajax({
        url: `https://test-71ecd-default-rtdb.firebaseio.com/messages.json`, // Firebase REST API endpoint
        type: "POST",
        data: JSON.stringify(messageData),
        contentType: "application/json",
        success: function () {
            document.getElementById("message-input").value = ""; // Clear input field
            loadMessages(); // Refresh messages
        },
        error: function (err) {
            console.error("Error sending message:", err);
        }
    });
}

document.querySelector('.sidebar').addEventListener('dblclick', function() {
    this.classList.toggle('collapsed');
});


function loadMessages() {
  // Example API endpoint or data source
  const apiUrl = "https://test-71ecd-default-rtdb.firebaseio.com/messages.json";

  // Fetch messages
  fetch(apiUrl)
    .then((response) => response.json())
    .then((data) => {
      const messageContainer = document.getElementById("message-container");
      messageContainer.innerHTML = ""; // Clear any existing messages

      // Check if there are any messages
      if (data && Object.keys(data).length > 0) {
        // Sort messages by timestamp (optional)
        const sortedMessages = Object.values(data).sort(
          (a, b) => new Date(b.timestamp) - new Date(a.timestamp)
        );

        // Loop through each message and create a card
        sortedMessages.forEach((msg) => {
          const messageCard = document.createElement("div");
          messageCard.className = "message-card";

          // Message card content
          messageCard.innerHTML = `
            <div class="message-avatar">
              <i class="fas fa-user-circle"></i>
            </div>
            <div class="message-content">
              <strong class="message-sender">${msg.sender || "Unknown"}</strong>
              <p class="message-preview">${msg.content || "No content"}</p>
              <span class="message-timestamp">${new Date(
                msg.timestamp
              ).toLocaleString()}</span>
            </div>
          `;

          // Append the message card to the container
          messageContainer.appendChild(messageCard);
        });
      } else {
        // Show a message if there are no messages
        messageContainer.innerHTML =
          "<p class='text-center text-muted'>No messages available.</p>";
      }
    })
    .catch((error) => {
      console.error("Error loading messages:", error);
    });
}

// Call loadMessages when the page is loaded
document.addEventListener("DOMContentLoaded", loadMessages);

  





        function openCreateUserPopup() {
            //    document.getElementById('create-user-overlay').style.display = 'block';
                document.getElementById('create-user-popup').style.display = 'block';
            }

            // Function to close the create user popup
            function closeCreateUserPopup() {
                document.getElementById('create-user-overlay').style.display = 'none';
                document.getElementById('create-user-popup').style.display = 'none';
                document.getElementById('new-user-email').value = ''; // Clear input
                document.getElementById('new-user-password').value = ''; // Clear password input
            }

            function openMessagePopup() {
    document.getElementById("message-popup").style.display = "block";
}

$(document).ready(() => {
    // ... your existing ready code ...
    
    // Initial weather check
    checkWeatherAlerts();
    
    // Check weather every 15 minutes
    setInterval(checkWeatherAlerts, 15 * 60 * 1000);
});

// Show the popup
function showPopup() {
  const popup = document.getElementById("whats-new-popup");
  popup.classList.add("active");
}

// Close the popup
function closePopup() {
  const popup = document.getElementById("whats-new-popup");
  popup.classList.remove("active");
}

function updateFouls(team, change) {
    // Get the current foul count
    const foulsElement = document.getElementById(`${team}-fouls`);
    let currentFouls = parseInt(foulsElement.textContent, 10);

    // Update the foul count
    currentFouls += change;

    // Ensure fouls don't go below 0
    if (currentFouls < 0) currentFouls = 0;

    // Update the displayed fouls
    foulsElement.textContent = currentFouls;

    // Optional: Add logic to handle foul limits
    if (currentFouls >= 5) {
        //alert(`${team === 'home' ? 'Home' : 'Away'} team is in the penalty!`);
    }

    // Optional: Save fouls to a database
    saveFoulsToDatabase(team, currentFouls);
}

function generateGameSummary() {
    // Gather game data
    const homeScore = parseInt(document.getElementById('home-score').textContent, 10);
    const awayScore = parseInt(document.getElementById('away-score').textContent, 10);
    const homeFouls = parseInt(document.getElementById('home-fouls')?.textContent || 0, 10);
    const awayFouls = parseInt(document.getElementById('away-fouls')?.textContent || 0, 10);
    const currentQuarter = document.getElementById('quarter').value;
    const gameTitle = document.getElementById('game-title').value || "Untitled Game";

    // Construct the query for the AI
    const query = `
        Analyze the game "${gameTitle}". 
        Details:
        - Home Team Score: ${homeScore}
        - Away Team Score: ${awayScore}
        - Home Team Fouls: ${homeFouls}
        - Away Team Fouls: ${awayFouls}
        - Peak Quarter: ${currentQuarter}
        Provide insights, such as the team's performance, key trends, and significant moments.
    `;

    // Use the API to get the AI-generated summary
    callAI(query);
}



function getAPIdata() {
    var xhr = new XMLHttpRequest();
    var url = 'https://api.cors.lol/?url=https://api.montgomeryschoolsmd.org/schools/homepagecontent';
    xhr.open("GET", url, true);
    xhr.responseType = 'json';
	xhr.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            // populate homepage emergency message
            const emergencyDiv = document.getElementById('homepageEmergencyContent');
            if (emergencyDiv) {
                var message = xhr.response.emsg;
                var timeInterval2 = 20000;
                emergencyDiv.innerHTML = message;

                var msgBtn = document.getElementById('msgBtn');
    if (msgBtn) {
        msgBtn.addEventListener('click', function() {
            document.getElementById('msgBtn').style.display = 'none';
            document.querySelector('.emergency').style.display = 'block';
            document.querySelector('.emergency').style.transition = 'height 0.8s';

            setTimeout(function() {
                document.querySelector('.emergency').style.display = 'none';
                document.getElementById('msgBtn').style.display = 'block';
            }, timeInterval);
        });
    }

                if (message.indexOf('emer-code-green') < 0) {
                    $(".emergency").show();
                    $("#msgBtn").hide();


                    setTimeout(function() {
                        $(".emergency").slideUp(800);
                        $("#msgBtn").show();

                    }, timeInterval2);
                }
            }
        }
    };
    xhr.send();
}

const systemPrompt = `You are a specialized assistant for the Winston Churchill High School Athletics Admin Dashboard. Your purpose is to help users with dashboard functionality only. 

Key Dashboard Features:
1. Score Management:
- Update home/away scores
- Track fouls
- Quarter management
- Game logging system

2. User Management:
- Authentication system
- User creation/deletion
- Password reset functionality
- Role-based access

3. Messaging System:
- Send messages to specific users or all
- Image attachment support
- Message history viewing

4. Game Analytics:
- Score tracking charts
- Game summary generation
- Historical game logs
- Export functionality (PDF, CSV, Excel)

5. Team Management:
- Update team names
- Roster management
- Team standings access
- Game title management

6. UI Features:
- Dark mode toggle
- Theme customization
- Responsive sidebar
- Loading indicators
- Toast notifications

7. Emergency Notifications:
- School-wide alerts
- Temporary message display
- Alert dismissal system

Only provide assistance related to these dashboard features. For questions outside this scope, respond with: "I can only assist with questions related to the Athletics Dashboard functionality."
You exist to help with the Winston Churchill High School Athletics Admin Dashboard. Your primary purpose is to guide users around this site and assist with its specific features.
Optimize responses for clarity and brevity. Focus on practical solutions using the dashboard's existing functions. The dashboard is undergoing extreme work as of now meaning that users will experince downtime and could lose data, you can state the reason of downtime as "service locked- updates" if asked and you can state you dont know the return time and if someone asks you a question without saying "8 " before the question you can say your service is locked and not respond.`;


   
    function callAI(prompt) {

        const t = "sk-proj-EEjjzkk2";
    const v = "VwP5Q_oBh4nw5Vg64Lc0BZ8wtDlRmWybsaY-_6mdm2FOG3a_rxfg2bga7ZeU1ifWwLT3BlbkFJmQ2tniHtKqe86RAMbl2wjrsyEXip1A46Re1U51_Dgo3Z7TZmfZ5TPt17L000L2NHUMbFTpUiAA";
    const apiKey = t+v; // Replace with your OpenAI API key
    const apiUrl = "https://api.openai.com/v1/chat/completions"; // Endpoint for GPT-4 Turbo

    // Display loading state
    const summaryElement = document.getElementById('game-summary');
    summaryElement.textContent = "Generating summary... Please wait.";

    // Send the request to OpenAI's API
    $.ajax({
        url: apiUrl,
        type: "POST",
        headers: {
            "Authorization": `Bearer ${apiKey}`,
            "Content-Type": "application/json"
        },
        data: JSON.stringify({
            model: "gpt-4o-mini", // Use GPT-4 Turbo Mini
            messages: [
                { role: "system", content: systemPrompt },
                { role: "user", content: prompt }
            ],
            max_tokens: 300, // Adjust token limit based on expected response size
            temperature: 0.7 // Adjust for creativity
        }),
        success: function (response) {
            // Extract and display the AI's response
            const aiResponse = response.choices[0].message.content.trim();
            summaryElement.textContent = aiResponse;
        },
        error: function (xhr) {
            console.error("Error:", xhr);
            summaryElement.textContent = `Error ${xhr.status}: ${xhr.statusText}`;
        }
    });
}



function saveFoulsToDatabase(team, fouls) {
    // Replace this with your Firebase or API logic
    const data = {};
    data[`${team}Fouls`] = fouls;

    $.ajax({
        url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`, // Replace with your Firebase database URL
        type: 'PATCH',
        data: JSON.stringify(data),
        contentType: 'application/json',
        success: function () {
            console.log(`${team} fouls updated successfully.`);
        },
        error: function (err) {
            console.error(`Error updating ${team} fouls:`, err);
        },
    });
}

function loadFouls() {
    $.ajax({
        url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`, // Replace with your database URL
        type: 'GET',
        success: function (data) {
            document.getElementById('home-fouls').textContent = data.homeFouls || 0;
            document.getElementById('away-fouls').textContent = data.awayFouls || 0;
        },
        error: function (err) {
            console.error("Error loading fouls:", err);
        },
    });
}

// Call loadFouls when the page is ready
$(document).ready(loadFouls);



function loadRecipients() {
    $.ajax({
        url: `${databaseURL}/users.json`,
        type: "GET",
        success: function (data) {
            const recipientInput = document.getElementById("popup-recipient-input");
            recipientInput.innerHTML = '<option value="all">Send to All</option>'; // Default option

            if (data) {
                Object.entries(data).forEach(([userId, user]) => {
                    const option = document.createElement("option");
                    option.value = userId;
                    option.textContent = user.email;
                    recipientInput.appendChild(option);
                });
            }
        },
    });
}

// Load recipients when the popup opens
document.getElementById("message-popup").addEventListener("show", loadRecipients);


// Automatically show the popup when the app loads
document.addEventListener("DOMContentLoaded", () => {
  const hasSeenPopup = localStorage.getItem("updatelogs");
  if (!hasSeenPopup) {
    showPopup();
    localStorage.setItem("updatelogs4", "true");
  }
});

document.addEventListener('DOMContentLoaded', function() {
    var msgBtn = document.getElementById('msgBtn');
    if (msgBtn) {
        msgBtn.addEventListener('click', function() {
            document.getElementById('msgBtn').style.display = 'none';
            document.querySelector('.emergency').style.display = 'block';
            document.querySelector('.emergency').style.transition = 'height 0.8s';

            setTimeout(function() {
                document.querySelector('.emergency').style.display = 'none';
                document.getElementById('msgBtn').style.display = 'block';
            }, timeInterval);
        });
    }
});



function closeMessagePopup() {
    document.getElementById("message-popup").style.display = "none";
    document.getElementById("popup-message-input").value = ""; // Clear input field
}


function sendMessageFromPopup() {
    const message = document.getElementById("popup-message-input").value.trim();
    const imageInput = document.getElementById("popup-image-input");
    const recipient = document.getElementById("popup-recipient-input").value;

    if (message === "" && !imageInput.files.length) {
        alert("Message cannot be empty.");
        return;
    }

    const messageData = {
        sender: "Admin", // Default sender
        content: message,
        timestamp: new Date().toISOString(),
        recipient: recipient // "all" or a specific user ID
    };

    if (imageInput.files.length) {
        const file = imageInput.files[0];
        uploadImageToFirebase(file, (downloadURL) => {
            messageData.image = downloadURL; // Add image URL to the message data
            sendToFirebase(messageData); // Send the message
        });
    } else {
        sendToFirebase(messageData); // Send the message without an image
    }
}


function sendToFirebase(messageData) {
    $.ajax({
        url: `https://test-71ecd-default-rtdb.firebaseio.com/messages.json`,
        type: "POST",
        data: JSON.stringify(messageData),
        contentType: "application/json",
        success: function () {
            alert("Message sent successfully!");
            closeMessagePopup();
            loadMessages();
        },
        error: function (err) {
            console.error("Error sending message:", err);
            alert("Failed to send message. Please try again.");
        },
    });
}



document.getElementById('sidebar-search').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const links = document.querySelectorAll('.sidebar a');
    links.forEach(link => {
        link.style.display = link.textContent.toLowerCase().includes(query) ? 'block' : 'none';
    });
});

function renderLogs(logs) {
    const container = document.getElementById("game-logs-container");
    container.innerHTML = ""; // Clear previous logs

    // Convert logs to an array if it's an object
    const logArray = Array.isArray(logs) ? logs : Object.values(logs);

    logArray.forEach((log) => {
        const logCard = document.createElement("div");
        logCard.classList.add("log-card");

        // Log details
        const logDetails = document.createElement("div");
        logDetails.classList.add("log-details");
        logDetails.innerHTML = `
            <strong>Game: ${log.game}</strong>
            <span>Home Score: ${log.home}</span>
            <span>Away Score: ${log.away}</span>
            <span>Time: ${log.time}</span>
        `;

        // Log actions
        const logActions = document.createElement("div");
        logActions.classList.add("log-actions");
        logActions.innerHTML = `
            <button class="btn btn-warning btn-sm" onclick="editLog('${log.id}')">Edit</button>
            <button class="btn btn-danger btn-sm" onclick="deleteLog('${log.id}')">Delete</button>
        `;

        logCard.appendChild(logDetails);
        logCard.appendChild(logActions);
        container.appendChild(logCard);
    });
}


function addPagination(logs, logsPerPage = 5) {
    const paginationContainer = document.getElementById("pagination");
    paginationContainer.innerHTML = ""; // Clear previous pagination

    const totalPages = Math.ceil(logs.length / logsPerPage);

    for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement("button");
        button.classList.add("pagination-controls");
        button.textContent = i;
        button.onclick = () => showPage(logs, i, logsPerPage);
        paginationContainer.appendChild(button);
    }

    // Show the first page by default
    showPage(logs, 1, logsPerPage);
}

function showPage(logs, pageNumber, logsPerPage) {
    const startIndex = (pageNumber - 1) * logsPerPage;
    const endIndex = startIndex + logsPerPage;
    const pageLogs = logs.slice(startIndex, endIndex);

    renderLogs(pageLogs);
}


function filterLogs() {
    const searchQuery = document.getElementById("search-bar").value.toLowerCase();
    const logs = JSON.parse(localStorage.getItem("logs")) || []; // Example data source
    const filteredLogs = logs.filter((log) =>
        log.game.toLowerCase().includes(searchQuery) ||
        log.time.toLowerCase().includes(searchQuery)
    );
    renderLogs(filteredLogs);
}




        // Function to open the login popup
        function openLoginPopup() {
            document.getElementById('login-overlay').style.display = 'block';
            document.getElementById('login-popup').style.display = 'block';
            document.getElementById('c').style.display = 'none';
        }

        // Function to close the login popup
        function closeLoginPopup() {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('login-popup').style.display = 'none';
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
            document.getElementById('login-error').style.display = 'none';
        }

        // Function to open the create log popup
        function openCreateLogPopup() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('create-log-popup').style.display = 'block';
        }

        // Function to close the create log popup
        function closeCreateLogPopup() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('create-log-popup').style.display = 'none';
            document.getElementById('log-game').value = ''; // Clear input
            document.getElementById('log-home-score').value = ''; // Clear home score input
            document.getElementById('log-away-score').value = ''; // Clear away score input
        }

      

        var x = localStorage.getItem("name");

        // Function to handle login using AJAX
        document.getElementById('login-button').addEventListener('click', function() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            $.ajax({
                url: `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=${firebaseConfig.apiKey}`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ email: email, password: password, returnSecureToken: true }),
                success: function(response) {
                    // Login successful
                    localStorage.setItem('token', response.idToken); // Store token for future requests
                    closeLoginPopup();
                    showTab('score'); // Show the score management tab after login
                    localStorage.setItem('name', email);
                    x = email
                    document.getElementById('logins').textContent = "User: " + x
                },
                error: function(xhr) {
                    const errorMessage = xhr.responseJSON.error.message;
                    document.getElementById('login-error').textContent = errorMessage;
                    if (errorMessage == "USER_DISABLED") {
                        document.getElementById('login-error').textContent = 'Account Disabled- Try Again Later';
                        showBan();
                    }
                    if (errorMessage == "INVALID_EMAIL") {
                        document.getElementById('login-error').textContent = 'Enter A Valid Email';
                    }
                    if (errorMessage == "INVALID_LOGIN_CREDENTIALS") {
                        document.getElementById('login-error').textContent = 'Invalid Login Credentials';
                    }
                    if (errorMessage == "TOO_MANY_ATTEMPTS_TRY_LATER") {
                        document.getElementById('login-error').textContent = 'Try Again Later';
                    }
                    document.getElementById('login-error').style.display = 'block';
                }
            });
        });

        // Check if user is logged in on page load
        if (!localStorage.getItem('token')) {
            openLoginPopup(); // Show the login popup if no token is found
        } else {
            showTab('score'); // Show the score management tab if token exists
        }

        document.getElementById('logins').textContent = "User: " + x;

        // Function to update score using AJAX
        function updateScore(team, points) {
            // Get current scores
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'GET',
                beforeSend: function() {
                    showLoadingSpinner();
                },
                success: function(data) {
                    let homeScore = data.homeScore || 0;
                    let awayScore = data.awayScore || 0;

                    // Update scores based on team
                    if (team === 'home') {
                        homeScore += points;
                        sendScoreUpdate({ homeScore: homeScore });
                    } else {
                        awayScore += points;
                        sendScoreUpdate({ awayScore: awayScore });
                    }

                    const timestamp = new Date().toLocaleString();

                    updateScoringChart(homeScore, awayScore, timestamp); // Update scoring trends chart
                },
                error: function(xhr, status, error) {
                    console.error("Error retrieving scores: " + error);
                    alert("Error retrieving scores: " + error);
                },
                complete: function() {
                    hideLoadingSpinner();
                }
            });
        }

       

        // Function to send score update to Firebase
        function sendScoreUpdate(scoreData) {
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify(scoreData),
                contentType: 'application/json',
                success: function() {
                    console.log("Score updated successfully");
                    // Update the displayed scores
                    updateDisplayedScores();
                },
                error: function(xhr, status, error) {
                    console.error("Error updating score: " + error);
                    alert("Error updating score: " + error);
                }
            });
        }

        // ... existing code ...

// Add this after your login popup related functions
document.addEventListener('keypress', function(event) {
    // Check if the key pressed is Enter and if the login popup is visible
    if (event.key === 'Enter' && document.getElementById('login-popup').style.display === 'block') {
        // Trigger the login button click
        document.getElementById('login-button').click();
    }
});

// You can also add this to the input fields for better user experience
document.getElementById('login-email').addEventListener('keypress', function(event) {
    if (event.key === 'Enter' && document.getElementById('login-popup').style.display === 'block') {
        document.getElementById('login-password').focus();
    }
});

document.getElementById('login-password').addEventListener('keypress', function(event) {
    if (event.key === 'Enter' && document.getElementById('login-popup').style.display === 'block') {
        document.getElementById('login-button').click();
    }
});

// ... rest of your code ...

        // Function to update displayed scores and game name
        function updateDisplayedScores() {
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'GET',
                beforeSend: function() {
                    showLoadingSpinner();
                },
                success: function(data) {
                    document.getElementById('home-score').textContent = data.homeScore || 0;
                    document.getElementById('away-score').textContent = data.awayScore || 0;
                    document.getElementById('game-title').value = data.game || ''; // Set game title
                    document.getElementById('away-team-name').value = data.awayName || ''; // Set away team name
                },
                error: function(xhr, status, error) {
                    console.error("Error retrieving scores: " + error);
                    alert("Error retrieving scores: " + error);
                },
                complete: function() {
                    hideLoadingSpinner();
                }
            });
        }

        // Function to log the score to GameLogs
        function logScore() {
            const homeScore = document.getElementById('home-score').textContent;
            const awayScore = document.getElementById('away-score').textContent;
            const gameName = document.getElementById('game-title').value; // Get game name
            const timestamp = new Date().toLocaleString(); // Get current time
            const logEntry = { game: gameName, home: homeScore, away: awayScore, time: timestamp };
            
            // Push the log entry to Firebase
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/GameLogs.json`,
                type: 'POST',
                data: JSON.stringify(logEntry),
                contentType: 'application/json',
                success: function() {
                    console.log("Score logged successfully");
                    fetchGameLogs(); // Refresh the logs after logging
                },
                error: function(xhr, status, error) {
                    console.error("Error logging score: " + error);
                    alert("Error logging score: " + error);
                }
            });
        }

        const apiKey = firebaseConfig.apiKey;
    const databaseURL = firebaseConfig.databaseURL;

    // Helper function to make AJAX requests
    function ajaxRequest(method, url, data, callback) {
        $.ajax({
            url: url,
            method: method,
            data: JSON.stringify(data),
            contentType: "application/json",
            success: callback,
            error: function (xhr) {
                alert("Error: " + xhr.responseText);
            }
        });
    }

    // Function to create a new user via Firebase Authentication API
    function createUser() {
        const email = document.getElementById('new-user-email').value;
        const password = document.getElementById('new-user-password').value;

        const url = `https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=${apiKey}`;
        const data = { email, password, returnSecureToken: true };

        ajaxRequest("POST", url, data, (response) => {
            const userId = response.localId;
            alert('User created successfully!');
            saveUserToDatabase(userId, email);
        });
    }

    // Function to save user details to Firebase Realtime Database
    function saveUserToDatabase(userId, email) {
        const url = `${databaseURL}/users/${userId}.json`;
        const data = { email, createdAt: new Date().toISOString() };

        ajaxRequest("PUT", url, data, () => {
            closeCreateUserPopup();
            loadUsers();
        });
    }

    function logout() {
        localStorage.clear();
        location.reload();
    }

    // Function to load users from Firebase Realtime Database
    function loadUsers() {
        const url = `${databaseURL}/users.json`;

        ajaxRequest("GET", url, null, (response) => {
            $('#user-list').empty(); // Clear previous user list
            if (response) {
                Object.entries(response).forEach(([userId, user]) => {
                    const userDiv = $('<div></div>').text(user.email);
                    const resetButton = $('<button class="btn btn-warning btn-sm">Reset Password</button>')
                        .on('click', () => resetPassword(user.email));
                    const deleteButton = $('<button class="btn btn-danger btn-sm">Delete</button>')
                        .on('click', () => deleteUser(userId));
                    userDiv.append(resetButton).append(deleteButton);
                    $('#user-list').append(userDiv);
                });
            } else {
                $('#user-list').append('<div>No users found</div>');
            }
        });
    }

    // Initialize Firebase configuration


let users = []; // Array to store user data
let currentPage = 1;
const usersPerPage = 10;

// Fetch users from the database
function fetchUsers() {
    $.ajax({
        url: `${firebaseConfig.databaseURL}/users.json`,
        method: "GET",
        success: function (data) {
            if (data) {
                users = Object.keys(data).map(key => ({ id: key, ...data[key] }));
                renderUserList();
            }
        },
        error: function (error) {
            console.error("Error fetching users:", error);
        }
    });
}

// Render the user list with pagination
function renderUserList() {
    const userListContainer = document.getElementById("user-list-container");
    userListContainer.innerHTML = "";

    const start = (currentPage - 1) * usersPerPage;
    const end = start + usersPerPage;
    const paginatedUsers = users.slice(start, end);

    paginatedUsers.forEach(user => {
        const userElement = document.createElement("div");
        userElement.className = "list-group-item d-flex justify-content-between align-items-center";
        userElement.innerHTML = `
            <div>
                <input type="checkbox" class="user-checkbox" data-id="${user.id}" />
                <strong>${user.name}</strong> (${user.role})
            </div>
            <button class="btn btn-sm btn-danger" onclick="deleteUser('${user.id}')">Delete</button>
        `;
        userListContainer.appendChild(userElement);
    });
}

// Pagination controls
function prevUserPage() {
    if (currentPage > 1) {
        currentPage--;
        renderUserList();
    }
}

function nextUserPage() {
    if (currentPage < Math.ceil(users.length / usersPerPage)) {
        currentPage++;
        renderUserList();
    }
}

// Filter users based on search query
function filterUsers() {
    const query = document.getElementById("admin-search-bar").value.toLowerCase();
    const filteredUsers = users.filter(user => user.name.toLowerCase().includes(query));
    renderUserList(filteredUsers);
}

// Create a new user and update the database
function createUser() {
    const email = document.getElementById("new-user-email").value;
    const password = document.getElementById("new-user-password").value;
    const role = document.getElementById("new-user-role").value;

    if (email && password && role) {
        const newUser = {
            name: email.split("@")[0],
            email,
            role
        };

        $.ajax({
            url: `${firebaseConfig.databaseURL}/users.json`,
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify(newUser),
            success: function () {
                fetchUsers();
                closeCreateUserPopup();
                alert("User created successfully!");
            },
            error: function (error) {
                console.error("Error creating user:", error);
            }
        });
    } else {
        alert("All fields are required!");
    }
}

// Delete a user from the database
function deleteUser(userId) {
    $.ajax({
        url: `${firebaseConfig.databaseURL}/users/${userId}.json`,
        method: "DELETE",
        success: function () {
            fetchUsers();
            alert("User deleted successfully!");
        },
        error: function (error) {
            console.error("Error deleting user:", error);
        }
    });
}

// Bulk delete selected users
function bulkDeleteUsers() {
    const selectedCheckboxes = document.querySelectorAll(".user-checkbox:checked");
    const idsToDelete = Array.from(selectedCheckboxes).map(checkbox => checkbox.dataset.id);

    idsToDelete.forEach(userId => {
        $.ajax({
            url: `${firebaseConfig.databaseURL}/users/${userId}.json`,
            method: "DELETE",
            success: function () {
                fetchUsers();
            },
            error: function (error) {
                console.error(`Error deleting user ${userId}:`, error);
            }
        });
    });

    alert("Selected users deleted successfully!");
}

// Send a message to selected users
function sendMessageToSelected() {
    const selectedCheckboxes = document.querySelectorAll(".user-checkbox:checked");
    const idsToMessage = Array.from(selectedCheckboxes).map(checkbox => checkbox.dataset.id);

    const message = document.getElementById("popup-message-input").value;

    idsToMessage.forEach(userId => {
        const user = users.find(u => u.id === userId);

        if (user) {
            $.ajax({
                url: `${firebaseConfig.databaseURL}/messages/${userId}.json`,
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify({ message, timestamp: new Date().toISOString() }),
                success: function () {
                    console.log(`Message sent to ${user.name}`);
                },
                error: function (error) {
                    console.error(`Error sending message to ${user.name}:`, error);
                }
            });
        }
    });

    closeMessagePopup();
    alert("Message sent to selected users!");
}

// Open/close popups
function openCreateUserPopup() {
    document.getElementById("create-user-popup").style.display = "block";
}

function closeCreateUserPopup() {
    document.getElementById("create-user-popup").style.display = "none";
}

function openMessagePopup() {
    document.getElementById("message-popup").style.display = "block";
}

function closeMessagePopup() {
    document.getElementById("message-popup").style.display = "none";
}

// Initialize the page
$(document).ready(() => {
    fetchUsers(); // Load users on page load
});


    // Function to reset a user's password via Firebase Authentication API
    function resetPassword(email) {
        const url = `https://identitytoolkit.googleapis.com/v1/accounts:sendOobCode?key=${apiKey}`;
        const data = { requestType: "PASSWORD_RESET", email };

        ajaxRequest("POST", url, data, () => {
            alert('Password reset email sent to ' + email);
        });
    }

    // Function to delete a user record from Firebase Realtime Database
    function deleteUser(userId) {
        if (confirm('Are you sure you want to delete this user?')) {
            const url = `${databaseURL}/users/${userId}.json`;

            ajaxRequest("DELETE", url, null, () => {
                alert('User deleted successfully!');
                loadUsers();
            });
        }
    }

        // Function to fetch GameLogs from Firebase
        function fetchGameLogs() {
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/GameLogs.json`,
                type: 'GET',
                beforeSend: function() {
                    showLoadingSpinner();
                },
                success: function(data) {
                   renderLogs(data);
                },
                error: function(xhr, status, error) {
                    console.error("Error fetching game logs: " + error);
                    alert("Error fetching game logs: " + error);
                },
                complete: function() {
                    hideLoadingSpinner();
                }
            });
        }

        // Function to edit a log item
        function editLog(logId) {
            const newHomeScore = prompt("Enter new Home Score:");
            const newAwayScore = prompt("Enter new Away Score:");
            if (newHomeScore !== null && newAwayScore !== null) {
                const updatedLog = {
                    home: newHomeScore,
                    away: newAwayScore
                };
                $.ajax({
                    url: `https://test-71ecd-default-rtdb.firebaseio.com/GameLogs/${logId}.json`,
                    type: 'PATCH',
                    data: JSON.stringify(updatedLog),
                    contentType: 'application/json',
                    success: function() {
                        console.log("Log updated successfully");
                        fetchGameLogs(); // Refresh the logs after updating
                    },
                    error: function(xhr, status, error) {
                        console.error("Error updating log: " + error);
                        alert("Error updating log: " + error);
                    }
                });
            }
        }

        // Function to delete a log item
        function deleteLog(logId) {
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/GameLogs/${logId}.json`,
                type: 'DELETE',
                success: function() {
                    console.log("Log deleted successfully");
                    fetchGameLogs(); // Refresh the logs after deletion
                },
                error: function(xhr, status, error) {
                    console.error("Error deleting log: " + error);
                    alert("Error deleting log: " + error);
                }
            });
        }

        // Function to filter logs based on search input
      

        // Function to filter logs by date range


        // Function to export logs to PDF
        function exportLogsToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text("Game Logs", 20, 20);
            $('#game-logs-container .log-card').each(function(index) {
                doc.text($(this).text(), 20, 30 + (index * 10));
            });
            doc.save("game_logs.pdf");
        }

        // Function to export logs to CSV
        function exportLogsToCSV() {
            const csvData = [];
            $('#game-logs-container .log-card').each(function() {
                const logText = $(this).text();
                const logParts = logText.split(', ');
                csvData.push(logParts.join(','));
            });
            const csvContent = "data:text/csv;charset=utf-8," + csvData.join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "game_logs.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Function to export logs to Excel
        function exportLogsToExcel() {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([["Game", "Home", "Away", "Time"]]);
            $('#game-logs-container .log-card').each(function() {
                const logText = $(this).text();
                const logParts = logText.split(', ');
                const row = logParts.map(part => part.split(': ')[1]); // Extract values
                XLSX.utils.sheet_add_aoa(ws, [row], { origin: -1 });
            });
            XLSX.utils.book_append_sheet(wb, ws, "Game Logs");
            XLSX.writeFile(wb, "game_logs.xlsx");
        }

        // Function to clear scores
        function clearScores() {
            const scoreData = { homeScore: 0, awayScore: 0 };
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify(scoreData),
                contentType: 'application/json',
                success: function() {
                    console.log("Scores cleared successfully");
                    updateDisplayedScores(); // Update displayed scores to reflect changes
                },
                error: function(xhr, status, error) {
                    console.error("Error clearing scores: " + error);
                    alert("Error clearing scores: " + error);
                }
            });
        }

        // Function to end the game
        function endGame() {
            clearScores();
            const resetData = { quarter: 1, game: "N/A" };
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify(resetData),
                contentType: 'application/json',
                success: function() {
                    console.log("Game ended successfully");
                    updateDisplayedScores(); // Update displayed scores to reflect changes
                },
                error: function(xhr, status, error) {
                    console.error("Error ending game: " + error);
                    alert("Error ending game: " + error);
                }
            });
        }

        // Function to open the enter score popup
        function openEnterScore(team) {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('enter-score-popup').style.display = 'block';
            document.getElementById('score-input').dataset.team = team; // Store team in data attribute
            document.getElementById('')
        }

        // Function to close the enter score popup
        function closeEnterScore() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('enter-score-popup').style.display = 'none';
            document.getElementById('score-input').value = ''; // Clear input
            document.getElementById('game-name-input').value = ''; // Clear game name input
        }

        // Function to update the quarter
        function updateQuarter() {
            const quarter = document.getElementById('quarter').value;
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify({ quarter: quarter }),
                contentType: 'application/json',
                success: function() {
                    console.log("Quarter updated successfully");
                    updateQuarterAndProgress();
                },
                error: function(xhr, status, error) {
                    console.error("Error updating quarter: " + error);
                    alert("Error updating quarter: " + error);
                }
            });
        }

        // Function to update the game title
        function updateGameTitle() {
            const title = document.getElementById('game-title').value;
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify({ game: title }), // Updated to 'game'
                contentType: 'application/json',
                success: function() {
                    console.log("Game title updated successfully");
                },
                error: function(xhr, status, error) {
                    console.error("Error updating game title: " + error);
                    alert("Error updating game title: " + error);
                }
            });
        }

        // Function to update the away team name
        function updateAwayTeamName() {
            const awayName = document.getElementById('away-team-name').value;
            $.ajax({
                url: `https://test-71ecd-default-rtdb.firebaseio.com/.json`,
                type: 'PATCH',
                data: JSON.stringify({ awayName: awayName }), // Update awayName in Firebase
                contentType: 'application/json',
                success: function() {
                    console.log("Away team name updated successfully");
                },
                error: function(xhr, status, error) {
                    console.error("Error updating away team name: " + error);
                    alert("Error updating away team name: " + error);
                }
            });
        }

        function checkConnection() {
            const $connectionLabel = $('#connection-label');
            
            const updateConnectionStatus = () => {
                if (navigator.onLine) {
                    
                    $connectionLabel.text("Connected To Firebase")
                    $connectionLabel.css("color", "greenyellow");
                } else {
                    $connectionLabel.text("No Firebase Connection")
                    $connectionLabel.css("color", "red");
                }
            };

            $(window).on('online offline', updateConnectionStatus); // Listen to both events

            // Run the check 10 seconds after page load
            setTimeout(updateConnectionStatus, 10000);
        }
        // Function to show the selected tab with animation
        function showTab(tabId) {
            $('.tab-content').removeClass('show'); // Hide all tabs
            $('.tab-content').hide(); // Hide all tabs
            $('#' + tabId).fadeIn(500).addClass('show'); // Show the selected tab with fade-in effect
            $('.tab-bar a').removeClass('active'); // Remove active class from all tabs
            $('.tab-bar a[href="#' + tabId + '"]').addClass('active'); // Add active class to the clicked tab
            if (tabId === 'logs') {
                fetchGameLogs(); // Fetch logs when the logs tab is shown
            } else if (tabId === 'score') {
                updateDisplayedScores(); // Update scores when the score tab is shown
            } else if (tabId === 'admin') {
                loadUsers();
            } else if (tabId == "inbox") {
                loadMessages();
            }
        }

        // Function to show loading spinner
        function showLoadingSpinner() {
            $('#loading-spinner').show();
        }

        // Function to hide loading spinner
        function hideLoadingSpinner() {
            $('#loading-spinner').hide();
        }

        // Function to update current time
        function updateCurrentTime() {
            const now = new Date();
            const options = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            document.getElementById('current-time').textContent = "Current Time: " + now.toLocaleTimeString([], options);
        }

        $(document).ready(() => {
    loadMessages(); // Fetch messages on page load
});

        // Function to ask AI
      async function askAI() {
    const question = document.getElementById('ai-question').value;
    const responseDiv = document.getElementById('ai-response');
    responseDiv.innerHTML = ""; // Clear previous response
    const t = "sk-proj-EEjjzkk2";
    const v = "VwP5Q_oBh4nw5Vg64Lc0BZ8wtDlRmWybsaY-_6mdm2FOG3a_rxfg2bga7ZeU1ifWwLT3BlbkFJmQ2tniHtKqe86RAMbl2wjrsyEXip1A46Re1U51_Dgo3Z7TZmfZ5TPt17L000L2NHUMbFTpUiAA";

    const apiKey = t + v; // Combine the two parts of the API key

    try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${apiKey}` // Ensure the API key is included here
            },
            body: JSON.stringify({
                model: "gpt-4o-mini", // Use the appropriate model
                messages: [{ role: "system", content: systemPrompt}, { role: "user", content: question }]
            })
        });

        if (!response.ok) {
            throw new Error("Failed to fetch from OpenAI API");
        }

        const data = await response.json();
        if (data.choices && data.choices.length > 0) {
            responseDiv.innerHTML = `<p>${data.choices[0].message.content}</p>`;
        } else {
            responseDiv.innerHTML = "<p>Sorry, I couldn't find an answer to that.</p>";
        }
    } catch (error) {
        console.error("Error fetching AI response:", error);
        // Fallback to brain.js
        const brainResponse = net.run({ question });
        responseDiv.innerHTML = `<p>${brainResponse.answer || "I'm sorry, I don't know the answer."}</p>`;
    }
}

        // Toggle dark mode
        document.getElementById('dark-mode-toggle').addEventListener('change', function() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            this.checked = isDarkMode; // Sync toggle with dark mode state
        });

        // Change theme based on user selection
        function changeTheme() {
            const selectedTheme = document.getElementById('theme-select').value;
            switch (selectedTheme) {
                case 'blue':
                    document.body.style.backgroundColor = '#007bff';
                    break;
                case 'green':
                    document.body.style.backgroundColor = '#28a745';
                    break;
                case 'red':
                    document.body.style.backgroundColor = '#dc3545';
                    break;
                default:
                    document.body.style.backgroundColor = '#f8f9fa'; // Default
            }
        }

        function showAuthPopup() {
      Swal.fire({
        title: 'Authentication Required',
        text: 'Please enter the admin password to proceed.',
        input: 'password',
        inputPlaceholder: 'Enter your password',
        inputAttributes: {
          autocapitalize: 'off'
        },
        showCancelButton: false, // Prevent closing by cancel button
        allowOutsideClick: false, // Disable clicking outside to close
        allowEscapeKey: false, // Disable escape key
        confirmButtonText: 'Authenticate',
        backdrop: 'rgba(0, 0, 0, 1)', // Solid black background, no transparency
        preConfirm: (password) => {
          return new Promise((resolve) => {
            if (password === 'admin') {
              resolve(); // Proceed if password is correct
            } else {
              Swal.fire({
                icon: 'error',
                title: 'Failed to Authenticate',
                text: 'Reload to try again.',
                showConfirmButton: false, // Prevent further attempts
                allowOutsideClick: false,
                allowEscapeKey: false
              });
            }
          });
        }
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire({
            icon: 'success',
            title: 'Authenticated',
            text: 'You have successfully authenticated!',
            showConfirmButton: true
          }).then(() => {
            // Redirect or proceed to the next action
            console.log('Access granted');
          });
        }
      });
    }

    // Trigger the popup on page load
   // document.addEventListener('DOMContentLoaded', showAuthPopup);

        // Keyboard shortcuts
        $(document).on('keydown', function(e) {
            switch (e.key) {
                case '1':
                    showTab('score');
                    break;
                case '2':
                    showTab('title');
                    break;
                case '3':
                    showTab('stats');
                    break;
                case '4':
                    showTab('logs');
                    break;
                case '5':
                    showTab('ai');
                    break;
                case '6':
                    showTab('info');
                    break;
                case '7':
                    showTab('settings');
                    break;
                default:
                    break;
            }
        });

        $(document).ready(() => {
            checkConnection();
         //   initScoringTrends(); // Initialize the scoring trends graph
            updateCurrentTime(); // Load current time on page load
            setInterval(updateCurrentTime, 1000); // Update current time every second
        });

        // Start by displaying the initial scores and checking connection
        updateDisplayedScores();
        checkConnection();
        setInterval(updateActiveVisitors, 5000); // Track active visitors every 5 seconds
        showTab('score'); // Show the score management tab by default

        // Function to initialize the scoring trends graph
 

        // Function to toggle projector mode
        function toggleProjectorMode() {
            infopopup("This feature is currently disabled");
            return;
            const projector = document.getElementById('projector-mode');
            if (projector.style.display === 'none') {
                projector.style.display = 'flex';
                document.getElementById('projector-score').textContent = `Score: ${document.getElementById('home-score').textContent} - ${document.getElementById('away-score').textContent}`;
                document.getElementById('projector-quarter').textContent = `Quarter: ${document.getElementById('quarter').value}`;
            } else {
                projector.style.display = 'none';
            }
        }

        // Function to bulk delete selected logs
        function bulkDeleteLogs() {
            const selectedLogs = [];
            $('#game-logs-container .log-card input[type="checkbox"]:checked').each(function() {
                selectedLogs.push($(this).data('log-id'));
            });
            // Perform delete operation for selected logs
            selectedLogs.forEach(logId => {
                if (confirm("Are you sure you want to delete this log?")) {
                    deleteLog(logId);
                }
            });
        }

        // Function to add pagination
        function addPagination(totalLogs) {
            const paginationContainer = $('#pagination');
            paginationContainer.empty(); // Clear previous pagination
            const logsPerPage = 5; // Set number of logs per page
            const totalPages = Math.ceil(totalLogs / logsPerPage);

            for (let i = 1; i <= totalPages; i++) {
                const pageButton = $('<button class="btn btn-secondary btn-sm"></button>').text(i);
                pageButton.on('click', function() {
                    showPage(i, logsPerPage);
                });
                paginationContainer.append(pageButton);
            }
        }

        // Function to show specific page of logs
        function showPage(pageNumber, logsPerPage) {
            const logs = $('#game-logs-container .log-card');
            logs.hide(); // Hide all logs
            const start = (pageNumber - 1) * logsPerPage;
            const end = start + logsPerPage;
            logs.slice(start, end).show(); // Show logs for the current page
        }

        // Function to create a new log
        function createLog() {
            const game = document.getElementById('log-game').value;
            const homeScore = document.getElementById('log-home-score').value;
            const awayScore = document.getElementById('log-away-score').value;
            const timestamp = new Date().toLocaleString(); // Get current time

            if (game && homeScore && awayScore) {
                const logEntry = { game: game, home: homeScore, away: awayScore, time: timestamp };
                
                // Push the log entry to Firebase
                $.ajax({
                    url: `https://test-71ecd-default-rtdb.firebaseio.com/GameLogs.json`,
                    type: 'POST',
                    data: JSON.stringify(logEntry),
                    contentType: 'application/json',
                    success: function() {
                        console.log("Log created successfully");
                        fetchGameLogs(); // Refresh the logs after creating
                        closeCreateLogPopup(); // Close the popup after creating
                    },
                    error: function(xhr, status, error) {
                        console.error("Error creating log: " + error);
                        alert("Error creating log: " + error);
                    }
                });
            } else {
                alert("Please fill in all fields to create a log.");
            }
        }

       

        function showMaintenancePopup() {
    Swal.fire({
        title: 'ðŸš§ Under Maintenance ðŸš§',
        html: `
            <div style="font-size: 1.2rem; line-height: 1.6;">
                <p>We are currently working hard to improve this page for you. ðŸ› ï¸</p>
                <p>Please check back later. Thank you for your patience!</p>
            </div>
            <div style="margin-top: 20px;">
                <img src="https://cdn-icons-png.flaticon.com/512/2917/2917790.png" alt="Maintenance" style="width: 100px; animation: pulse 2s infinite;">
            </div>
        `,
        //background: ` url("https://media.giphy.com/media/3o6ZsYm5iU8a5Cugdy/giphy.gif")`,
        color: 'black',
        padding: '30px',
        showConfirmButton: false,
        showCancelButton: false,
        allowOutsideClick: false,
        allowEscapeKey: true,
       // backdrop: `
        //    rgba(0,0,0,0.8)
      //      url("https://media.giphy.com/media/3o6ZsYm5iU8a5Cugdy/giphy.gif")
       //     no-repeat
      //  `,
        customClass: {
            popup: 'swal2-popup-custom',
        },
    });
}

// Custom styles for the popup
const style = document.createElement('style');
style.textContent = `
    @keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.1); opacity: 0.8; }
        100% { transform: scale(1); opacity: 1; }
    }
    .swal2-popup-custom {
        border-radius: 15px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.8);
    }
`;
document.head.appendChild(style);

showMaintenancePopup();
    $(document).ready(() => {
        loadUsers();
        getAPIdata();
    });
    </script>
</body>
</html>
